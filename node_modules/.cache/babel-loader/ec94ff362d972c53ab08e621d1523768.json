{"ast":null,"code":"import _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/Modals/PublishCollectionModalWithOracle/PublishCollectionModal.tsx\";\nimport * as React from 'react';\nimport { BigNumber } from 'ethers';\nimport { Network } from '@dcl/schemas';\nimport { ModalNavigation, Button, Mana, Loader, Field, Form } from 'decentraland-ui';\nimport Modal from 'decentraland-dapps/dist/containers/Modal';\nimport { t, T } from 'decentraland-dapps/dist/modules/translation/utils';\nimport { config } from 'config';\nimport { fromWei } from 'web3x/utils';\nimport { Currency } from 'modules/item/types';\nimport { emailRegex } from 'lib/validators';\nimport './PublishCollectionModal.css';\n\nvar PublishCollectionModal = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(PublishCollectionModal, _React$PureComponent);\n\n  function PublishCollectionModal() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PublishCollectionModal);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PublishCollectionModal)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      step: 1,\n      email: undefined,\n      emailFocus: false\n    };\n\n    _this.handleNextStep = function () {\n      _this.setState({\n        step: 3\n      });\n    };\n\n    _this.handlePublish = function () {\n      var _this$props = _this.props,\n          collection = _this$props.collection,\n          items = _this$props.items,\n          onPublish = _this$props.onPublish;\n      var email = _this.state.email;\n      onPublish(collection, items, email);\n    };\n\n    _this.handleEmailChange = function (_, data) {\n      _this.setState({\n        email: data.value\n      });\n    };\n\n    _this.handleEmailFocus = function () {\n      _this.setState({\n        emailFocus: true\n      });\n    };\n\n    _this.handleEmailBlur = function () {\n      _this.setState({\n        emailFocus: false\n      });\n    };\n\n    _this.handleProceed = function () {\n      _this.setState({\n        step: 2\n      });\n    };\n\n    _this.renderFirstStep = function () {\n      var _this$props2 = _this.props,\n          items = _this$props2.items,\n          wallet = _this$props2.wallet,\n          onClose = _this$props2.onClose,\n          rarities = _this$props2.rarities,\n          itemError = _this$props2.itemError,\n          isFetchingItems = _this$props2.isFetchingItems,\n          isFetchingRarities = _this$props2.isFetchingRarities; // The UI is designed in a way that considers that all rarities have the same price, so only using the first one\n      // as reference for the prices is enough.\n\n      var refRarity = rarities[0];\n      var priceUSD;\n      var totalPrice;\n      var totalPriceUSD;\n      var hasInsufficientMANA = true;\n\n      if (refRarity) {\n        priceUSD = refRarity.prices.USD;\n        totalPrice = BigNumber.from(refRarity.prices.MANA).mul(items.length).toString();\n        totalPriceUSD = BigNumber.from(priceUSD).mul(items.length).toString();\n        hasInsufficientMANA = !!wallet && wallet.networks.MATIC.mana < Number(fromWei(totalPrice, 'ether'));\n      }\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal_with_oracle.title'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"first-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 9\n        }\n      }, isFetchingItems || isFetchingRarities || !refRarity ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loader-wrapper\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Loader, {\n        size: \"big\",\n        active: isFetchingItems || isFetchingRarities,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 15\n        }\n      })) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }\n      }, t('publish_collection_modal_with_oracle.items_breakdown_title', {\n        count: items.length,\n        publicationFee: fromWei(priceUSD, 'ether'),\n        currency: Currency.USD\n      })), /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://docs.decentraland.org/decentraland/publishing-wearables/\",\n        target: \"_blank\",\n        rel: \"noopener\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }\n      }, t('publish_collection_modal_with_oracle.learn_more')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"price-breakdown-container\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-header\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 19\n        }\n      }, t('publish_collection_modal_with_oracle.qty_of_items')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-content\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 19\n        }\n      }, items.length)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-header\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 19\n        }\n      }, t('publish_collection_modal_with_oracle.fee_per_item')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-content\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 19\n        }\n      }, Currency.USD, \" \", fromWei(priceUSD, 'ether'))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-header\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 19\n        }\n      }, t('publish_collection_modal_with_oracle.total_in_usd', {\n        currency: Currency.USD\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-content\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 19\n        }\n      }, Currency.USD, \" \", fromWei(totalPriceUSD, 'ether'))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-header\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 19\n        }\n      }, t('publish_collection_modal_with_oracle.total_in_mana')), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-content\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Mana, {\n        network: Network.MATIC,\n        size: \"medium\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }\n      }, fromWei(totalPrice, 'ether'))))), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"estimate-notice\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 15\n        }\n      }, t('publish_collection_modal_with_oracle.estimate_notice')), itemError && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"rarities-error error\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 19\n        }\n      }, t('publish_collection_modal_with_oracle.rarities_error')), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"rarities-error-sub error\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 19\n        }\n      }, itemError)), /*#__PURE__*/React.createElement(Button, {\n        className: \"proceed\",\n        primary: true,\n        fluid: true,\n        onClick: _this.handleProceed,\n        disabled: hasInsufficientMANA || !!itemError,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 15\n        }\n      }, t('global.next')), hasInsufficientMANA && /*#__PURE__*/React.createElement(\"small\", {\n        className: \"not-enough-mana-notice\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal_with_oracle.not_enough_mana\",\n        values: {\n          symbol: /*#__PURE__*/React.createElement(\"span\", {\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(Mana, {\n            network: Network.MATIC,\n            inline: true,\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 27\n            }\n          }), \" MANA\")\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal_with_oracle.get_mana\",\n        values: {\n          link: /*#__PURE__*/React.createElement(\"a\", {\n            href: config.get('ACCOUNT_URL', ''),\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 25\n            }\n          }, \"Account\")\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 19\n        }\n      })))));\n    };\n\n    _this.renderSecondStep = function () {\n      var onClose = _this.props.onClose;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal_with_oracle.title_tos'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"second-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 9\n        }\n      }, t('publish_collection_modal_with_oracle.first_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal_with_oracle.second_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal_with_oracle.third_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal_with_oracle.fourth_paragraph'), ' ', /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://docs.decentraland.org/wearables/publishing-wearables\",\n        rel: \"noopener noreferrer\",\n        target: \"_blank\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }\n      }, t('global.learn_more')), /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        fluid: true,\n        onClick: _this.handleNextStep,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }\n      }, t('global.next'))));\n    };\n\n    _this.renderThirdStep = function () {\n      var _this$props3 = _this.props,\n          isPublishLoading = _this$props3.isPublishLoading,\n          unsyncedCollectionError = _this$props3.unsyncedCollectionError,\n          collectionError = _this$props3.collectionError,\n          onClose = _this$props3.onClose;\n      var _this$state = _this.state,\n          email = _this$state.email,\n          emailFocus = _this$state.emailFocus;\n      var hasValidEmail = emailRegex.test(email !== null && email !== void 0 ? email : '');\n      var showEmailError = !hasValidEmail && !emailFocus && email !== undefined && email !== '';\n      var error = unsyncedCollectionError || collectionError;\n      return /*#__PURE__*/React.createElement(Form, {\n        onSubmit: _this.handlePublish,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal_with_oracle.title_tos'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"third-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tos\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal_with_oracle.tos_title')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal_with_oracle.tos_first_condition\",\n        values: {\n          terms_of_use: /*#__PURE__*/React.createElement(\"a\", {\n            href: \"https://decentraland.org/terms/\",\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 21\n            }\n          }, t('publish_collection_modal_with_oracle.terms_of_use')),\n          content_policy: /*#__PURE__*/React.createElement(\"a\", {\n            href: \"https://decentraland.org/content/\",\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 21\n            }\n          }, t('publish_collection_modal_with_oracle.content_policy'))\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal_with_oracle.tos_second_condition')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal_with_oracle.tos_third_condition'))), /*#__PURE__*/React.createElement(Field, {\n        label: t('global.email'),\n        placeholder: 'email@decentraland.org',\n        onFocus: _this.handleEmailFocus,\n        onBlur: _this.handleEmailBlur,\n        onChange: _this.handleEmailChange,\n        error: showEmailError,\n        message: showEmailError ? t('publish_collection_modal_with_oracle.invalid_email') : undefined,\n        value: email,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(Modal.Actions, {\n        className: \"third-step-footer\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        fluid: true,\n        disabled: !hasValidEmail || isPublishLoading || !!error,\n        loading: isPublishLoading,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }\n      }, t('global.publish')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }\n      }, t('publish_collection_modal_with_oracle.accept_by_publishing')), error && /*#__PURE__*/React.createElement(\"p\", {\n        className: \"error\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }\n      }, t('publish_collection_modal_with_oracle.unsynced_collection'))));\n    };\n\n    _this.renderStep = function () {\n      var step = _this.state.step;\n\n      switch (step) {\n        case 1:\n          return _this.renderFirstStep();\n\n        case 2:\n          return _this.renderSecondStep();\n\n        case 3:\n          return _this.renderThirdStep();\n\n        default:\n          throw new Error('Step not found');\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(PublishCollectionModal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props4 = this.props,\n          collection = _this$props4.collection,\n          onClose = _this$props4.onClose,\n          onFetchRarities = _this$props4.onFetchRarities;\n\n      if (!collection) {\n        onClose();\n      }\n\n      onFetchRarities();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var onClose = this.props.onClose;\n      var step = this.state.step;\n      return /*#__PURE__*/React.createElement(Modal, {\n        className: \"PublishCollectionModal\",\n        size: step !== 1 ? 'tiny' : undefined,\n        onClose: onClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 7\n        }\n      }, this.renderStep());\n    }\n  }]);\n\n  return PublishCollectionModal;\n}(React.PureComponent);\n\nexport { PublishCollectionModal as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/Modals/PublishCollectionModalWithOracle/PublishCollectionModal.tsx"],"names":["React","BigNumber","Network","ModalNavigation","Button","Mana","Loader","Field","Form","Modal","t","T","config","fromWei","Currency","emailRegex","PublishCollectionModal","state","step","email","undefined","emailFocus","handleNextStep","setState","handlePublish","props","collection","items","onPublish","handleEmailChange","_","data","value","handleEmailFocus","handleEmailBlur","handleProceed","renderFirstStep","wallet","onClose","rarities","itemError","isFetchingItems","isFetchingRarities","refRarity","priceUSD","totalPrice","totalPriceUSD","hasInsufficientMANA","prices","USD","from","MANA","mul","length","toString","networks","MATIC","mana","Number","count","publicationFee","currency","symbol","link","get","renderSecondStep","renderThirdStep","isPublishLoading","unsyncedCollectionError","collectionError","hasValidEmail","test","showEmailError","error","terms_of_use","content_policy","renderStep","Error","onFetchRarities","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { BigNumber } from 'ethers'\nimport { Network } from '@dcl/schemas'\nimport { ModalNavigation, Button, Mana, Loader, Field, InputOnChangeData, Form } from 'decentraland-ui'\nimport Modal from 'decentraland-dapps/dist/containers/Modal'\nimport { t, T } from 'decentraland-dapps/dist/modules/translation/utils'\nimport { config } from 'config'\nimport { fromWei } from 'web3x/utils'\nimport { Currency, Rarity } from 'modules/item/types'\nimport { emailRegex } from 'lib/validators'\nimport { Props, State } from './PublishCollectionModal.types'\nimport './PublishCollectionModal.css'\n\nexport default class PublishCollectionModal extends React.PureComponent<Props, State> {\n  state: State = { step: 1, email: undefined, emailFocus: false }\n\n  componentDidMount() {\n    const { collection, onClose, onFetchRarities } = this.props\n\n    if (!collection) {\n      onClose()\n    }\n\n    onFetchRarities()\n  }\n\n  handleNextStep = () => {\n    this.setState({ step: 3 })\n  }\n\n  handlePublish = () => {\n    const { collection, items, onPublish } = this.props\n    const { email } = this.state\n    onPublish(collection!, items, email!)\n  }\n\n  handleEmailChange = (_: unknown, data: InputOnChangeData): void => {\n    this.setState({ email: data.value })\n  }\n\n  handleEmailFocus = () => {\n    this.setState({ emailFocus: true })\n  }\n\n  handleEmailBlur = () => {\n    this.setState({ emailFocus: false })\n  }\n\n  handleProceed = () => {\n    this.setState({ step: 2 })\n  }\n\n  renderFirstStep = () => {\n    const { items, wallet, onClose, rarities, itemError, isFetchingItems, isFetchingRarities } = this.props\n\n    // The UI is designed in a way that considers that all rarities have the same price, so only using the first one\n    // as reference for the prices is enough.\n    const refRarity: Rarity | undefined = rarities[0]\n\n    let priceUSD: string | undefined\n    let totalPrice: string | undefined\n    let totalPriceUSD: string | undefined\n    let hasInsufficientMANA = true\n\n    if (refRarity) {\n      priceUSD = refRarity.prices!.USD\n\n      totalPrice = BigNumber.from(refRarity.prices!.MANA)\n        .mul(items.length)\n        .toString()\n\n      totalPriceUSD = BigNumber.from(priceUSD)\n        .mul(items.length)\n        .toString()\n\n      hasInsufficientMANA = !!wallet && wallet.networks.MATIC.mana < Number(fromWei(totalPrice, 'ether'))\n    }\n\n    return (\n      <>\n        <ModalNavigation title={t('publish_collection_modal_with_oracle.title')} onClose={onClose} />\n        <Modal.Content className=\"first-step\">\n          {isFetchingItems || isFetchingRarities || !refRarity ? (\n            <div className=\"loader-wrapper\">\n              <Loader size=\"big\" active={isFetchingItems || isFetchingRarities} />\n            </div>\n          ) : (\n            <>\n              <p>\n                {t('publish_collection_modal_with_oracle.items_breakdown_title', {\n                  count: items.length,\n                  publicationFee: fromWei(priceUSD!, 'ether'),\n                  currency: Currency.USD\n                })}\n              </p>\n              <a href=\"https://docs.decentraland.org/decentraland/publishing-wearables/\" target=\"_blank\" rel=\"noopener\">\n                {t('publish_collection_modal_with_oracle.learn_more')}\n              </a>\n              <div className=\"price-breakdown-container\">\n                <div className=\"element\">\n                  <div className=\"element-header\">{t('publish_collection_modal_with_oracle.qty_of_items')}</div>\n                  <div className=\"element-content\">{items.length}</div>\n                </div>\n                <div className=\"element\">\n                  <div className=\"element-header\">{t('publish_collection_modal_with_oracle.fee_per_item')}</div>\n                  <div className=\"element-content\">\n                    {Currency.USD} {fromWei(priceUSD!, 'ether')}\n                  </div>\n                </div>\n                <div className=\"element\">\n                  <div className=\"element-header\">{t('publish_collection_modal_with_oracle.total_in_usd', { currency: Currency.USD })}</div>\n                  <div className=\"element-content\">\n                    {Currency.USD} {fromWei(totalPriceUSD!, 'ether')}\n                  </div>\n                </div>\n                <div className=\"element\">\n                  <div className=\"element-header\">{t('publish_collection_modal_with_oracle.total_in_mana')}</div>\n                  <div className=\"element-content\">\n                    <Mana network={Network.MATIC} size=\"medium\">\n                      {fromWei(totalPrice!, 'ether')}\n                    </Mana>\n                  </div>\n                </div>\n              </div>\n              <p className=\"estimate-notice\">{t('publish_collection_modal_with_oracle.estimate_notice')}</p>\n              {itemError && (\n                <>\n                  <p className=\"rarities-error error\">{t('publish_collection_modal_with_oracle.rarities_error')}</p>\n                  <p className=\"rarities-error-sub error\">{itemError}</p>\n                </>\n              )}\n              <Button className=\"proceed\" primary fluid onClick={this.handleProceed} disabled={hasInsufficientMANA || !!itemError}>\n                {t('global.next')}\n              </Button>\n              {hasInsufficientMANA && (\n                <small className=\"not-enough-mana-notice\">\n                  <T\n                    id=\"publish_collection_modal_with_oracle.not_enough_mana\"\n                    values={{\n                      symbol: (\n                        <span>\n                          <Mana network={Network.MATIC} inline /> MANA\n                        </span>\n                      )\n                    }}\n                  />\n                  <br />\n                  <T\n                    id=\"publish_collection_modal_with_oracle.get_mana\"\n                    values={{\n                      link: (\n                        <a href={config.get('ACCOUNT_URL', '')} rel=\"noopener noreferrer\" target=\"_blank\">\n                          Account\n                        </a>\n                      )\n                    }}\n                  />\n                </small>\n              )}\n            </>\n          )}\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderSecondStep = () => {\n    const { onClose } = this.props\n\n    return (\n      <>\n        <ModalNavigation title={t('publish_collection_modal_with_oracle.title_tos')} onClose={onClose} />\n        <Modal.Content className=\"second-step\">\n          {t('publish_collection_modal_with_oracle.first_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal_with_oracle.second_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal_with_oracle.third_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal_with_oracle.fourth_paragraph')}{' '}\n          <a href=\"https://docs.decentraland.org/wearables/publishing-wearables\" rel=\"noopener noreferrer\" target=\"_blank\">\n            {t('global.learn_more')}\n          </a>\n          <Button primary fluid onClick={this.handleNextStep}>\n            {t('global.next')}\n          </Button>\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderThirdStep = () => {\n    const { isPublishLoading, unsyncedCollectionError, collectionError, onClose } = this.props\n    const { email, emailFocus } = this.state\n    const hasValidEmail = emailRegex.test(email ?? '')\n    const showEmailError = !hasValidEmail && !emailFocus && email !== undefined && email !== ''\n    const error = unsyncedCollectionError || collectionError\n    return (\n      <Form onSubmit={this.handlePublish}>\n        <ModalNavigation title={t('publish_collection_modal_with_oracle.title_tos')} onClose={onClose} />\n        <Modal.Content className=\"third-step\">\n          <div className=\"tos\">\n            <p>{t('publish_collection_modal_with_oracle.tos_title')}</p>\n            <p>\n              <T\n                id=\"publish_collection_modal_with_oracle.tos_first_condition\"\n                values={{\n                  terms_of_use: (\n                    <a href=\"https://decentraland.org/terms/\" rel=\"noopener noreferrer\" target=\"_blank\">\n                      {t('publish_collection_modal_with_oracle.terms_of_use')}\n                    </a>\n                  ),\n                  content_policy: (\n                    <a href=\"https://decentraland.org/content/\" rel=\"noopener noreferrer\" target=\"_blank\">\n                      {t('publish_collection_modal_with_oracle.content_policy')}\n                    </a>\n                  )\n                }}\n              />\n            </p>\n            <p>{t('publish_collection_modal_with_oracle.tos_second_condition')}</p>\n            <p>{t('publish_collection_modal_with_oracle.tos_third_condition')}</p>\n          </div>\n          <Field\n            label={t('global.email')}\n            placeholder={'email@decentraland.org'}\n            onFocus={this.handleEmailFocus}\n            onBlur={this.handleEmailBlur}\n            onChange={this.handleEmailChange}\n            error={showEmailError}\n            message={showEmailError ? t('publish_collection_modal_with_oracle.invalid_email') : undefined}\n            value={email}\n          />\n        </Modal.Content>\n        <Modal.Actions className=\"third-step-footer\">\n          <Button primary fluid disabled={!hasValidEmail || isPublishLoading || !!error} loading={isPublishLoading}>\n            {t('global.publish')}\n          </Button>\n          <p>{t('publish_collection_modal_with_oracle.accept_by_publishing')}</p>\n          {error && <p className=\"error\">{t('publish_collection_modal_with_oracle.unsynced_collection')}</p>}\n        </Modal.Actions>\n      </Form>\n    )\n  }\n\n  renderStep = () => {\n    const { step } = this.state\n    switch (step) {\n      case 1:\n        return this.renderFirstStep()\n      case 2:\n        return this.renderSecondStep()\n      case 3:\n        return this.renderThirdStep()\n      default:\n        throw new Error('Step not found')\n    }\n  }\n\n  render() {\n    const { onClose } = this.props\n    const { step } = this.state\n\n    return (\n      <Modal className=\"PublishCollectionModal\" size={step !== 1 ? 'tiny' : undefined} onClose={onClose}>\n        {this.renderStep()}\n      </Modal>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}