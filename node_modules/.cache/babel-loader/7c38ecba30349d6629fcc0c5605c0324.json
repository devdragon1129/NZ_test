{"ast":null,"code":"import _regeneratorRuntime from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { future } from 'fp-future';\nexport var debounce = function debounce(fn, ms) {\n  var timeout = null;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    timeout = setTimeout(function () {\n      return fn.apply(void 0, args);\n    }, ms);\n  };\n};\nexport var debounceByKey = function debounceByKey(fn, ms) {\n  var timeouts = {};\n  var futures = {};\n  return function (key) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    var timeout = timeouts[key];\n\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n\n    if (!futures[key]) {\n      futures[key] = future();\n    }\n\n    timeouts[key] = setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var promise;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              promise = futures[key];\n\n              if (!promise) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.prev = 2;\n              _context.next = 5;\n              return fn.apply(void 0, args);\n\n            case 5:\n              promise.resolve();\n              _context.next = 11;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](2);\n              promise.reject(_context.t0);\n\n            case 11:\n              delete futures[key];\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 8]]);\n    })), ms);\n    return futures[key];\n  };\n};\nexport var throttle = function throttle(fn, ms) {\n  var timers = {};\n  return function (key) {\n    var timer = timers[key];\n    var now = +Date.now();\n\n    if (!timer || now >= timer + ms) {\n      timers[key] = +Date.now();\n\n      for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        args[_key3 - 1] = arguments[_key3];\n      }\n\n      return fn.apply(void 0, args);\n    }\n  };\n};","map":{"version":3,"sources":["/opt/work/NZ_test/src/lib/debounce.ts"],"names":["future","debounce","fn","ms","timeout","args","clearTimeout","setTimeout","debounceByKey","timeouts","futures","key","promise","resolve","reject","throttle","timers","timer","now","Date"],"mappings":";;AAAA,SAASA,MAAT,QAAgC,WAAhC;AAEA,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,EAAD,EAAeC,EAAf,EAA8B;AACpD,MAAIC,OAAY,GAAG,IAAnB;AACA,SAAO,YAAoB;AAAA,sCAAhBC,IAAgB;AAAhBA,MAAAA,IAAgB;AAAA;;AACzB,QAAID,OAAJ,EAAa;AACXE,MAAAA,YAAY,CAACF,OAAD,CAAZ;AACD;;AACDA,IAAAA,OAAO,GAAGG,UAAU,CAAC;AAAA,aAAML,EAAE,MAAF,SAAMG,IAAN,CAAN;AAAA,KAAD,EAAoBF,EAApB,CAApB;AACD,GALD;AAMD,CARM;AAUP,OAAO,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAAoCN,EAApC,EAA2CC,EAA3C,EAA0D;AACrF,MAAIM,QAA6B,GAAG,EAApC;AACA,MAAIC,OAAsC,GAAG,EAA7C;AAEA,SAAO,UAACC,GAAD,EAAwD;AAAA,uCAAvCN,IAAuC;AAAvCA,MAAAA,IAAuC;AAAA;;AAC7D,QAAMD,OAAO,GAAGK,QAAQ,CAACE,GAAD,CAAxB;;AACA,QAAIP,OAAJ,EAAa;AACXE,MAAAA,YAAY,CAACF,OAAD,CAAZ;AACD;;AACD,QAAI,CAACM,OAAO,CAACC,GAAD,CAAZ,EAAmB;AACjBD,MAAAA,OAAO,CAACC,GAAD,CAAP,GAAeX,MAAM,EAArB;AACD;;AACDS,IAAAA,QAAQ,CAACE,GAAD,CAAR,GAAgBJ,UAAU,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AACnBK,cAAAA,OADmB,GACTF,OAAO,CAACC,GAAD,CADE;;AAAA,mBAErBC,OAFqB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAIfV,EAAE,MAAF,SAAMG,IAAN,CAJe;;AAAA;AAKrBO,cAAAA,OAAO,CAACC,OAAR;AALqB;AAAA;;AAAA;AAAA;AAAA;AAOrBD,cAAAA,OAAO,CAACE,MAAR;;AAPqB;AASvB,qBAAOJ,OAAO,CAACC,GAAD,CAAd;;AATuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD,IAWvBR,EAXuB,CAA1B;AAYA,WAAOO,OAAO,CAACC,GAAD,CAAd;AACD,GArBD;AAsBD,CA1BM;AA4BP,OAAO,IAAMI,QAAQ,GAAG,SAAXA,QAAW,CAAoCb,EAApC,EAA2CC,EAA3C,EAA0D;AAChF,MAAIa,MAA8B,GAAG,EAArC;AAEA,SAAO,UAACL,GAAD,EAAyC;AAC9C,QAAMM,KAAK,GAAGD,MAAM,CAACL,GAAD,CAApB;AACA,QAAMO,GAAG,GAAG,CAACC,IAAI,CAACD,GAAL,EAAb;;AAEA,QAAI,CAACD,KAAD,IAAUC,GAAG,IAAID,KAAK,GAAGd,EAA7B,EAAiC;AAC/Ba,MAAAA,MAAM,CAACL,GAAD,CAAN,GAAc,CAACQ,IAAI,CAACD,GAAL,EAAf;;AAD+B,yCAJXb,IAIW;AAJXA,QAAAA,IAIW;AAAA;;AAE/B,aAAOH,EAAE,MAAF,SAAMG,IAAN,CAAP;AACD;AACF,GARD;AASD,CAZM","sourcesContent":["import { future, IFuture } from 'fp-future'\n\nexport const debounce = (fn: Function, ms: number) => {\n  let timeout: any = null\n  return (...args: any[]) => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => fn(...args), ms)\n  }\n}\n\nexport const debounceByKey = <T extends (...args: any[]) => any>(fn: T, ms: number) => {\n  let timeouts: Record<string, any> = {}\n  let futures: Record<string, IFuture<void>> = {}\n\n  return (key: string, ...args: Parameters<T>): Promise<void> => {\n    const timeout = timeouts[key]\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    if (!futures[key]) {\n      futures[key] = future()\n    }\n    timeouts[key] = setTimeout(async () => {\n      const promise = futures[key]\n      if (promise) {\n        try {\n          await fn(...args)\n          promise.resolve()\n        } catch (e) {\n          promise.reject(e as Error)\n        }\n        delete futures[key]\n      }\n    }, ms)\n    return futures[key]\n  }\n}\n\nexport const throttle = <T extends (...args: any[]) => any>(fn: T, ms: number) => {\n  let timers: Record<string, number> = {}\n\n  return (key: string, ...args: Parameters<T>) => {\n    const timer = timers[key]\n    const now = +Date.now()\n\n    if (!timer || now >= timer + ms) {\n      timers[key] = +Date.now()\n      return fn(...args)\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}