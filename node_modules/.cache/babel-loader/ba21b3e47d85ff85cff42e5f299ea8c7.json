{"ast":null,"code":"import _objectSpread from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/Modals/EditAssetPackModal/EditAssetPackModal.tsx\";\nimport * as React from 'react';\nimport uuidv4 from 'uuid/v4';\nimport { Button, ModalNavigation, Row } from 'decentraland-ui';\nimport { getAnalytics } from 'decentraland-dapps/dist/modules/analytics/utils';\nimport { t } from 'decentraland-dapps/dist/modules/translation/utils';\nimport Modal from 'decentraland-dapps/dist/containers/Modal';\nimport { ProgressStage } from 'modules/assetPack/types';\nimport AssetPackEditor from 'components/AssetPackEditor';\nimport { convertToFullAssetPack } from 'modules/assetPack/utils';\nimport AssetImporter from 'components/AssetImporter';\nimport AssetsEditor from 'components/AssetsEditor';\nimport { EditAssetPackView } from './EditAssetPackModal.types';\nimport './EditAssetPackModal.css';\n\nvar EditAssetPackModal = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(EditAssetPackModal, _React$PureComponent);\n\n  function EditAssetPackModal() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EditAssetPackModal);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EditAssetPackModal)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      view: EditAssetPackView.EDIT_ASSET_PACK,\n      back: EditAssetPackView.EDIT_ASSET_PACK,\n      assetPack: _this.getRawAssetPack(),\n      editingAsset: null,\n      ignoredAssets: _this.getRemoteAssetIds(),\n      isDirty: false\n    };\n    _this.analytics = getAnalytics();\n\n    _this.handleAssetPackChange = function (assetPack) {\n      var ignoredAssets = _this.state.ignoredAssets;\n\n      _this.setState({\n        assetPack: assetPack,\n        ignoredAssets: ignoredAssets.filter(function (id) {\n          return assetPack.assets.some(function (asset) {\n            return asset.id === id;\n          });\n        }),\n        isDirty: true\n      });\n    };\n\n    _this.handleAssetImportSubmit = function (assetPack) {\n      _this.analytics.track('Edit Asset Pack Assets Review');\n\n      _this.setState({\n        assetPack: assetPack,\n        view: EditAssetPackView.EDIT_ASSETS,\n        isDirty: true\n      });\n    };\n\n    _this.handleAssetEditorSubmit = function (assetPack) {\n      _this.analytics.track('Edit Asset Pack Review');\n\n      _this.setState({\n        assetPack: assetPack,\n        view: EditAssetPackView.EDIT_ASSET_PACK,\n        editingAsset: null,\n        isDirty: true\n      });\n    };\n\n    _this.handleAssetPackEditorSubmit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(assetPack) {\n        var ignoredAssets, _yield$convertToFullA, _yield$convertToFullA2, fullAssetPack, contents;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                ignoredAssets = _this.state.ignoredAssets; // Convert to FullAssetPack but ignore all the original remote Assets\n\n                _context.next = 3;\n                return convertToFullAssetPack(assetPack, ignoredAssets);\n\n              case 3:\n                _yield$convertToFullA = _context.sent;\n                _yield$convertToFullA2 = _slicedToArray(_yield$convertToFullA, 2);\n                fullAssetPack = _yield$convertToFullA2[0];\n                contents = _yield$convertToFullA2[1];\n\n                _this.props.onCreateAssetPack(fullAssetPack, contents);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleAddAssets = function () {\n      _this.setState({\n        view: EditAssetPackView.IMPORT\n      });\n    };\n\n    _this.handleEditAsset = function (asset) {\n      _this.setState({\n        view: EditAssetPackView.EDIT_ASSETS,\n        editingAsset: asset.id\n      });\n    };\n\n    _this.handleDeleteAssetPack = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _this$state, ignoredAssets, assetPack, _yield$convertToFullA3, _yield$convertToFullA4, fullAssetPack;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$state = _this.state, ignoredAssets = _this$state.ignoredAssets, assetPack = _this$state.assetPack;\n              _context2.next = 3;\n              return convertToFullAssetPack(assetPack, ignoredAssets);\n\n            case 3:\n              _yield$convertToFullA3 = _context2.sent;\n              _yield$convertToFullA4 = _slicedToArray(_yield$convertToFullA3, 1);\n              fullAssetPack = _yield$convertToFullA4[0];\n\n              _this.props.onDeleteAssetPack(fullAssetPack);\n\n              _this.props.onClose();\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    _this.handleConfirmDeleteAssetPack = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this.setState({\n                view: EditAssetPackView.CONFIRM_DELETE\n              });\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    _this.handleReset = function () {\n      var assetPack = _this.props.assetPack;\n\n      if (assetPack) {\n        _this.setState({\n          view: EditAssetPackView.IMPORT,\n          assetPack: {\n            id: assetPack.id,\n            title: assetPack.title,\n            thumbnail: assetPack.thumbnail,\n            ethAddress: assetPack.ethAddress,\n            assets: []\n          },\n          isDirty: true\n        });\n      }\n    };\n\n    _this.handleBackToStart = function () {\n      _this.setState({\n        view: EditAssetPackView.EDIT_ASSET_PACK,\n        editingAsset: null\n      });\n    };\n\n    _this.handleClose = function () {\n      var _this$state2 = _this.state,\n          view = _this$state2.view,\n          isDirty = _this$state2.isDirty;\n      var onClose = _this.props.onClose;\n\n      switch (view) {\n        case EditAssetPackView.SUCCESS:\n        case EditAssetPackView.IMPORT:\n          onClose();\n          break;\n\n        case EditAssetPackView.EDIT_ASSETS:\n        case EditAssetPackView.EDIT_ASSET_PACK:\n          if (isDirty) {\n            _this.setState({\n              view: EditAssetPackView.EXIT,\n              back: view\n            });\n          } else {\n            onClose();\n          }\n\n          break;\n\n        case EditAssetPackView.EXIT:\n        case EditAssetPackView.PROGRESS:\n          // can't close here\n          break;\n      }\n    };\n\n    _this.handleBack = function () {\n      _this.setState({\n        view: _this.state.back\n      });\n    };\n\n    _this.renderAssetImport = function () {\n      var assetPack = _this.state.assetPack;\n      var onClose = _this.props.onClose;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.edit_assetpack.title_edit'),\n        subtitle: t('asset_pack.edit_assetpack.description_edit'),\n        onClose: onClose,\n        onBack: _this.handleBackToStart,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(AssetImporter, {\n        assetPack: assetPack,\n        onSubmit: _this.handleAssetImportSubmit,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }\n      })));\n    };\n\n    _this.renderAssetEditor = function () {\n      var _this$state3 = _this.state,\n          assetPack = _this$state3.assetPack,\n          editingAsset = _this$state3.editingAsset,\n          ignoredAssets = _this$state3.ignoredAssets;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.edit_asset.title_edit'),\n        subtitle: t('asset_pack.edit_asset.description_edit'),\n        onClose: _this.handleClose,\n        onBack: editingAsset ? _this.handleBackToStart : undefined,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(AssetsEditor, {\n        assetPack: assetPack,\n        onChange: _this.handleAssetPackChange,\n        onSubmit: _this.handleAssetEditorSubmit,\n        startingAsset: editingAsset || undefined,\n        ignoredAssets: !editingAsset ? ignoredAssets : [],\n        isEditing: !!editingAsset,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }\n      })));\n    };\n\n    _this.renderAssetpackEditor = function () {\n      var _this$state4 = _this.state,\n          assetPack = _this$state4.assetPack,\n          ignoredAssets = _this$state4.ignoredAssets;\n      var error = _this.props.error;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.edit_assetpack.title_edit'),\n        subtitle: t('asset_pack.edit_assetpack.description_edit'),\n        onClose: _this.handleClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(AssetPackEditor, {\n        assetPack: assetPack,\n        remoteAssets: ignoredAssets,\n        onChange: _this.handleAssetPackChange,\n        onSubmit: _this.handleAssetPackEditorSubmit,\n        onReset: _this.handleReset,\n        onAddAssets: _this.handleAddAssets,\n        onEditAsset: _this.handleEditAsset,\n        onDeleteAssetPack: _this.handleConfirmDeleteAssetPack,\n        error: error,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }\n      })));\n    };\n\n    _this.renderProgress = function () {\n      var progress = _this.props.progress;\n      var className = 'progress-bar';\n\n      if (progress.value === 100) {\n        className += ' active';\n      }\n\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.progress.updating_asset_pack'),\n        subtitle: t('asset_pack.progress.uploading_contents'),\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"progress-bar-container\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: className,\n        style: {\n          width: \"\".concat(progress.value, \"%\")\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }\n      }))));\n    };\n\n    _this.renderSuccess = function () {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.success.title'),\n        subtitle: t('asset_pack.success.description'),\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        center: true,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        onClick: _this.props.onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }\n      }, t('asset_pack.success.continue')))));\n    };\n\n    return _this;\n  }\n\n  _createClass(EditAssetPackModal, [{\n    key: \"getRawAssetPack\",\n    value: function getRawAssetPack() {\n      var _this$props = this.props,\n          assetPack = _this$props.assetPack,\n          ethAddress = _this$props.ethAddress;\n\n      if (!assetPack) {\n        var id = uuidv4();\n        return {\n          id: id,\n          title: '',\n          thumbnail: '',\n          ethAddress: ethAddress || null,\n          assets: []\n        };\n      }\n\n      return {\n        id: assetPack.id,\n        title: assetPack.title,\n        thumbnail: assetPack.thumbnail,\n        ethAddress: assetPack.ethAddress,\n        assets: assetPack.assets.map(function (asset) {\n          return _objectSpread({}, asset, {\n            model: asset.model.replace(\"\".concat(asset.id, \"/\"), '')\n          });\n        })\n      };\n    }\n  }, {\n    key: \"getRemoteAssetIds\",\n    value: function getRemoteAssetIds() {\n      var remotePack = this.props.assetPack;\n      if (!remotePack) return [];\n      return remotePack.assets.map(function (asset) {\n        return asset.id;\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var _this$props2 = this.props,\n          progress = _this$props2.progress,\n          error = _this$props2.error,\n          isLoading = _this$props2.isLoading;\n      var view = this.state.view;\n\n      if (progress.stage === ProgressStage.UPLOAD_CONTENTS && progress.value === 100 && !error && !isLoading) {\n        view = EditAssetPackView.SUCCESS;\n      } else if (progress.stage !== ProgressStage.NONE && !error) {\n        view = EditAssetPackView.PROGRESS;\n      } else if (error) {\n        view = EditAssetPackView.EDIT_ASSET_PACK;\n      }\n\n      this.setState({\n        view: view\n      });\n    }\n  }, {\n    key: \"renderExit\",\n    value: function renderExit() {\n      var onClose = this.props.onClose;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.exit.title_edit'),\n        subtitle: t('asset_pack.exit.description_edit'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Actions, {\n        className: \"exit-actions\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        onClick: onClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 11\n        }\n      }, t('asset_pack.exit.action')), /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleBack,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }\n      }, t('asset_pack.exit.back'))));\n    }\n  }, {\n    key: \"renderDeleteConfirmation\",\n    value: function renderDeleteConfirmation() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('asset_pack.confirm_delete.title'),\n        subtitle: t('asset_pack.confirm_delete.description'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Actions, {\n        className: \"exit-actions\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        onClick: this.handleDeleteAssetPack,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }\n      }, t('asset_pack.confirm_delete.action')), /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleBack,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }\n      }, t('asset_pack.confirm_delete.back'))));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var name = this.props.name;\n      var view = this.state.view;\n      var content;\n      var className = name;\n\n      switch (view) {\n        case EditAssetPackView.IMPORT:\n          content = this.renderAssetImport();\n          break;\n\n        case EditAssetPackView.EDIT_ASSETS:\n          content = this.renderAssetEditor();\n          break;\n\n        case EditAssetPackView.EDIT_ASSET_PACK:\n          content = this.renderAssetpackEditor();\n          break;\n\n        case EditAssetPackView.PROGRESS:\n          content = this.renderProgress();\n          break;\n\n        case EditAssetPackView.SUCCESS:\n          content = this.renderSuccess();\n          break;\n\n        case EditAssetPackView.EXIT:\n          content = this.renderExit();\n          className += ' narrow';\n          break;\n\n        case EditAssetPackView.CONFIRM_DELETE:\n          content = this.renderDeleteConfirmation();\n          className += ' narrow';\n          break;\n\n        default:\n          content = null;\n      }\n\n      return /*#__PURE__*/React.createElement(Modal, {\n        name: name,\n        className: className,\n        onClose: this.handleClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 7\n        }\n      }, content);\n    }\n  }]);\n\n  return EditAssetPackModal;\n}(React.PureComponent);\n\nexport { EditAssetPackModal as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/Modals/EditAssetPackModal/EditAssetPackModal.tsx"],"names":["React","uuidv4","Button","ModalNavigation","Row","getAnalytics","t","Modal","ProgressStage","AssetPackEditor","convertToFullAssetPack","AssetImporter","AssetsEditor","EditAssetPackView","EditAssetPackModal","state","view","EDIT_ASSET_PACK","back","assetPack","getRawAssetPack","editingAsset","ignoredAssets","getRemoteAssetIds","isDirty","analytics","handleAssetPackChange","setState","filter","id","assets","some","asset","handleAssetImportSubmit","track","EDIT_ASSETS","handleAssetEditorSubmit","handleAssetPackEditorSubmit","fullAssetPack","contents","props","onCreateAssetPack","handleAddAssets","IMPORT","handleEditAsset","handleDeleteAssetPack","onDeleteAssetPack","onClose","handleConfirmDeleteAssetPack","CONFIRM_DELETE","handleReset","title","thumbnail","ethAddress","handleBackToStart","handleClose","SUCCESS","EXIT","PROGRESS","handleBack","renderAssetImport","renderAssetEditor","undefined","renderAssetpackEditor","error","renderProgress","progress","className","value","width","renderSuccess","map","model","replace","remotePack","isLoading","stage","UPLOAD_CONTENTS","NONE","name","content","renderExit","renderDeleteConfirmation","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport uuidv4 from 'uuid/v4'\nimport { Button, ModalNavigation, Row } from 'decentraland-ui'\nimport { getAnalytics } from 'decentraland-dapps/dist/modules/analytics/utils'\nimport { RawAsset, Asset } from 'modules/asset/types'\nimport { t } from 'decentraland-dapps/dist/modules/translation/utils'\nimport Modal from 'decentraland-dapps/dist/containers/Modal'\nimport { ProgressStage, MixedAssetPack } from 'modules/assetPack/types'\nimport AssetPackEditor from 'components/AssetPackEditor'\nimport { convertToFullAssetPack } from 'modules/assetPack/utils'\nimport AssetImporter from 'components/AssetImporter'\nimport AssetsEditor from 'components/AssetsEditor'\n\nimport { Props, State, EditAssetPackView } from './EditAssetPackModal.types'\nimport './EditAssetPackModal.css'\n\nexport default class EditAssetPackModal extends React.PureComponent<Props, State> {\n  state: State = {\n    view: EditAssetPackView.EDIT_ASSET_PACK,\n    back: EditAssetPackView.EDIT_ASSET_PACK,\n    assetPack: this.getRawAssetPack(),\n    editingAsset: null,\n    ignoredAssets: this.getRemoteAssetIds(),\n    isDirty: false\n  }\n\n  analytics = getAnalytics()\n\n  getRawAssetPack(): MixedAssetPack {\n    const { assetPack, ethAddress } = this.props\n\n    if (!assetPack) {\n      const id = uuidv4()\n      return {\n        id,\n        title: '',\n        thumbnail: '',\n        ethAddress: ethAddress || null,\n        assets: []\n      }\n    }\n\n    return {\n      id: assetPack.id,\n      title: assetPack.title,\n      thumbnail: assetPack.thumbnail,\n      ethAddress: assetPack.ethAddress,\n      assets: assetPack.assets.map(asset => ({ ...asset, model: asset.model.replace(`${asset.id}/`, '') }))\n    }\n  }\n\n  getRemoteAssetIds() {\n    const remotePack = this.props.assetPack\n    if (!remotePack) return []\n    return remotePack.assets.map(asset => asset.id)\n  }\n\n  componentDidUpdate() {\n    const { progress, error, isLoading } = this.props\n    let view: EditAssetPackView = this.state.view\n\n    if (progress.stage === ProgressStage.UPLOAD_CONTENTS && progress.value === 100 && !error && !isLoading) {\n      view = EditAssetPackView.SUCCESS\n    } else if (progress.stage !== ProgressStage.NONE && !error) {\n      view = EditAssetPackView.PROGRESS\n    } else if (error) {\n      view = EditAssetPackView.EDIT_ASSET_PACK\n    }\n\n    this.setState({ view })\n  }\n\n  handleAssetPackChange = (assetPack: MixedAssetPack) => {\n    const { ignoredAssets } = this.state\n    this.setState({ assetPack, ignoredAssets: ignoredAssets.filter(id => assetPack.assets.some(asset => asset.id === id)), isDirty: true })\n  }\n\n  handleAssetImportSubmit = (assetPack: MixedAssetPack) => {\n    this.analytics.track('Edit Asset Pack Assets Review')\n    this.setState({ assetPack, view: EditAssetPackView.EDIT_ASSETS, isDirty: true })\n  }\n\n  handleAssetEditorSubmit = (assetPack: MixedAssetPack) => {\n    this.analytics.track('Edit Asset Pack Review')\n    this.setState({ assetPack, view: EditAssetPackView.EDIT_ASSET_PACK, editingAsset: null, isDirty: true })\n  }\n\n  handleAssetPackEditorSubmit = async (assetPack: MixedAssetPack) => {\n    const { ignoredAssets } = this.state\n    // Convert to FullAssetPack but ignore all the original remote Assets\n    const [fullAssetPack, contents] = await convertToFullAssetPack(assetPack, ignoredAssets)\n    this.props.onCreateAssetPack(fullAssetPack, contents)\n  }\n\n  handleAddAssets = () => {\n    this.setState({\n      view: EditAssetPackView.IMPORT\n    })\n  }\n\n  handleEditAsset = (asset: RawAsset | Asset) => {\n    this.setState({\n      view: EditAssetPackView.EDIT_ASSETS,\n      editingAsset: asset.id\n    })\n  }\n\n  handleDeleteAssetPack = async () => {\n    const { ignoredAssets, assetPack } = this.state\n    const [fullAssetPack] = await convertToFullAssetPack(assetPack, ignoredAssets)\n    this.props.onDeleteAssetPack(fullAssetPack)\n    this.props.onClose()\n  }\n\n  handleConfirmDeleteAssetPack = async () => {\n    this.setState({\n      view: EditAssetPackView.CONFIRM_DELETE\n    })\n  }\n\n  handleReset = () => {\n    const { assetPack } = this.props\n    if (assetPack) {\n      this.setState({\n        view: EditAssetPackView.IMPORT,\n        assetPack: {\n          id: assetPack.id,\n          title: assetPack.title,\n          thumbnail: assetPack.thumbnail,\n          ethAddress: assetPack.ethAddress,\n          assets: []\n        },\n        isDirty: true\n      })\n    }\n  }\n\n  handleBackToStart = () => {\n    this.setState({\n      view: EditAssetPackView.EDIT_ASSET_PACK,\n      editingAsset: null\n    })\n  }\n\n  handleClose = () => {\n    const { view, isDirty } = this.state\n    const { onClose } = this.props\n    switch (view) {\n      case EditAssetPackView.SUCCESS:\n      case EditAssetPackView.IMPORT:\n        onClose()\n        break\n      case EditAssetPackView.EDIT_ASSETS:\n      case EditAssetPackView.EDIT_ASSET_PACK:\n        if (isDirty) {\n          this.setState({ view: EditAssetPackView.EXIT, back: view })\n        } else {\n          onClose()\n        }\n        break\n      case EditAssetPackView.EXIT:\n      case EditAssetPackView.PROGRESS:\n        // can't close here\n        break\n    }\n  }\n\n  handleBack = () => {\n    this.setState({ view: this.state.back })\n  }\n\n  renderAssetImport = () => {\n    const { assetPack } = this.state\n    const { onClose } = this.props\n\n    return (\n      <>\n        <ModalNavigation\n          title={t('asset_pack.edit_assetpack.title_edit')}\n          subtitle={t('asset_pack.edit_assetpack.description_edit')}\n          onClose={onClose}\n          onBack={this.handleBackToStart}\n        />\n        <Modal.Content>\n          <AssetImporter assetPack={assetPack} onSubmit={this.handleAssetImportSubmit} />\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderAssetEditor = () => {\n    const { assetPack, editingAsset, ignoredAssets } = this.state\n\n    return (\n      <>\n        <ModalNavigation\n          title={t('asset_pack.edit_asset.title_edit')}\n          subtitle={t('asset_pack.edit_asset.description_edit')}\n          onClose={this.handleClose}\n          onBack={editingAsset ? this.handleBackToStart : undefined}\n        />\n        <Modal.Content>\n          <AssetsEditor\n            assetPack={assetPack}\n            onChange={this.handleAssetPackChange}\n            onSubmit={this.handleAssetEditorSubmit}\n            startingAsset={editingAsset || undefined}\n            ignoredAssets={!editingAsset ? ignoredAssets : []}\n            isEditing={!!editingAsset}\n          />\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderAssetpackEditor = () => {\n    const { assetPack, ignoredAssets } = this.state\n    const { error } = this.props\n\n    return (\n      <>\n        <ModalNavigation\n          title={t('asset_pack.edit_assetpack.title_edit')}\n          subtitle={t('asset_pack.edit_assetpack.description_edit')}\n          onClose={this.handleClose}\n        />\n        <Modal.Content>\n          <AssetPackEditor\n            assetPack={assetPack!}\n            remoteAssets={ignoredAssets}\n            onChange={this.handleAssetPackChange}\n            onSubmit={this.handleAssetPackEditorSubmit}\n            onReset={this.handleReset}\n            onAddAssets={this.handleAddAssets}\n            onEditAsset={this.handleEditAsset}\n            onDeleteAssetPack={this.handleConfirmDeleteAssetPack}\n            error={error}\n          />\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderProgress = () => {\n    const { progress } = this.props\n    let className = 'progress-bar'\n\n    if (progress.value === 100) {\n      className += ' active'\n    }\n\n    return (\n      <>\n        <ModalNavigation title={t('asset_pack.progress.updating_asset_pack')} subtitle={t('asset_pack.progress.uploading_contents')} />\n        <Modal.Content>\n          <div className=\"progress-bar-container\">\n            <div className={className} style={{ width: `${progress.value}%` }} />\n          </div>\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderSuccess = () => {\n    return (\n      <>\n        <ModalNavigation title={t('asset_pack.success.title')} subtitle={t('asset_pack.success.description')} />\n        <Modal.Content>\n          <Row center>\n            <Button primary onClick={this.props.onClose}>\n              {t('asset_pack.success.continue')}\n            </Button>\n          </Row>\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderExit() {\n    const { onClose } = this.props\n    return (\n      <>\n        <ModalNavigation title={t('asset_pack.exit.title_edit')} subtitle={t('asset_pack.exit.description_edit')} />\n        <Modal.Actions className=\"exit-actions\">\n          <Button primary onClick={onClose}>\n            {t('asset_pack.exit.action')}\n          </Button>\n          <Button onClick={this.handleBack}>{t('asset_pack.exit.back')}</Button>\n        </Modal.Actions>\n      </>\n    )\n  }\n\n  renderDeleteConfirmation() {\n    return (\n      <>\n        <ModalNavigation title={t('asset_pack.confirm_delete.title')} subtitle={t('asset_pack.confirm_delete.description')} />\n        <Modal.Actions className=\"exit-actions\">\n          <Button primary onClick={this.handleDeleteAssetPack}>\n            {t('asset_pack.confirm_delete.action')}\n          </Button>\n          <Button onClick={this.handleBack}>{t('asset_pack.confirm_delete.back')}</Button>\n        </Modal.Actions>\n      </>\n    )\n  }\n\n  render() {\n    const { name } = this.props\n    const { view } = this.state\n\n    let content\n    let className = name\n    switch (view) {\n      case EditAssetPackView.IMPORT:\n        content = this.renderAssetImport()\n        break\n      case EditAssetPackView.EDIT_ASSETS:\n        content = this.renderAssetEditor()\n        break\n      case EditAssetPackView.EDIT_ASSET_PACK:\n        content = this.renderAssetpackEditor()\n        break\n      case EditAssetPackView.PROGRESS:\n        content = this.renderProgress()\n        break\n      case EditAssetPackView.SUCCESS:\n        content = this.renderSuccess()\n        break\n      case EditAssetPackView.EXIT:\n        content = this.renderExit()\n        className += ' narrow'\n        break\n      case EditAssetPackView.CONFIRM_DELETE:\n        content = this.renderDeleteConfirmation()\n        className += ' narrow'\n        break\n      default:\n        content = null\n    }\n\n    return (\n      <Modal name={name} className={className} onClose={this.handleClose}>\n        {content}\n      </Modal>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}