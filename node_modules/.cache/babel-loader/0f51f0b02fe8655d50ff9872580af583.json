{"ast":null,"code":"import _regeneratorRuntime from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/ClaimENSPage/ClaimENSPage.tsx\";\nimport * as React from 'react';\nimport { Row, Column, Section, Narrow, Header, Form, Field, Button, Mana, Radio, Popup } from 'decentraland-ui';\nimport { Network } from '@dcl/schemas';\nimport { T, t } from 'decentraland-dapps/dist/modules/translation/utils';\nimport { getTokenAmountToApprove } from 'decentraland-dapps/dist/modules/authorization/utils';\nimport { NetworkButton, NetworkCheck, TransactionLink } from 'decentraland-dapps/dist/containers';\nimport Back from 'components/Back';\nimport LoggedInDetailPage from 'components/LoggedInDetailPage';\nimport { locations } from 'routing/locations';\nimport { MAX_NAME_SIZE, PRICE, isNameValid, isNameAvailable, hasNameMinLength, isEnoughClaimMana } from 'modules/ens/utils';\nimport { CONTROLLER_ADDRESS } from 'modules/common/contracts';\nimport './ClaimENSPage.css';\n\nvar ClaimENSPage = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(ClaimENSPage, _React$PureComponent);\n\n  function ClaimENSPage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ClaimENSPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ClaimENSPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      name: '',\n      isLoading: false,\n      isAvailable: true,\n      isError: false\n    };\n    _this.handleManaApprove = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _this$props, allowance, onAllowMana, manaToAllow;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$props = _this.props, allowance = _this$props.allowance, onAllowMana = _this$props.onAllowMana;\n              manaToAllow = isEnoughClaimMana(allowance) ? 0 : getTokenAmountToApprove();\n              onAllowMana(manaToAllow.toString());\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    _this.handleClaim = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _this$props2, wallet, mana, allowance, onOpenModal, name, isValid, isEnoughMana, isManaAllowed, isAvailable;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$props2 = _this.props, wallet = _this$props2.wallet, mana = _this$props2.mana, allowance = _this$props2.allowance, onOpenModal = _this$props2.onOpenModal;\n              name = _this.state.name;\n              isValid = isNameValid(name);\n              isEnoughMana = wallet && isEnoughClaimMana(mana.toString());\n              isManaAllowed = isEnoughClaimMana(allowance);\n\n              if (!(!isValid || !isEnoughMana || !isManaAllowed)) {\n                _context2.next = 7;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 7:\n              _this.setState({\n                isLoading: true\n              });\n\n              _context2.prev = 8;\n              _context2.next = 11;\n              return isNameAvailable(name);\n\n            case 11:\n              isAvailable = _context2.sent;\n\n              if (isAvailable) {\n                onOpenModal('ClaimNameFatFingerModal', {\n                  originalName: name\n                });\n\n                _this.setState({\n                  isLoading: false\n                });\n              } else {\n                _this.setState({\n                  isAvailable: false,\n                  isLoading: false\n                });\n              }\n\n              _context2.next = 18;\n              break;\n\n            case 15:\n              _context2.prev = 15;\n              _context2.t0 = _context2[\"catch\"](8);\n\n              _this.setState({\n                isLoading: false,\n                isAvailable: true,\n                isError: true\n              });\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[8, 15]]);\n    }));\n\n    _this.handleNameChange = function (_event, data) {\n      var isAvailable = _this.state.isAvailable;\n\n      if (data.value.length <= MAX_NAME_SIZE) {\n        if (!isAvailable) {\n          _this.setState({\n            name: data.value,\n            isAvailable: true,\n            isError: false\n          });\n        } else {\n          _this.setState({\n            name: data.value,\n            isError: false\n          });\n        }\n      }\n    };\n\n    _this.handleBack = function () {\n      _this.props.onNavigate(locations.root());\n    };\n\n    _this.handleAction = function () {\n      /* noop */\n    };\n\n    return _this;\n  }\n\n  _createClass(ClaimENSPage, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          wallet = _this$props3.wallet,\n          mana = _this$props3.mana,\n          allowance = _this$props3.allowance,\n          onBack = _this$props3.onBack;\n      var _this$state = this.state,\n          name = _this$state.name,\n          isError = _this$state.isError,\n          isAvailable = _this$state.isAvailable;\n      var isLoading = this.props.isLoading || this.state.isLoading;\n      var isValid = isNameValid(name);\n      var isEnoughMana = wallet && isEnoughClaimMana(mana.toString());\n      var isManaAllowed = isEnoughClaimMana(allowance);\n      var isDisabled = !isValid || !isAvailable || !isEnoughMana || !isManaAllowed;\n      var message = '';\n\n      if (isError) {\n        message = t('claim_ens_page.error_message');\n      } else if (!isAvailable) {\n        message = t('claim_ens_page.repeated_message');\n      } else if (name.length <= 2) {\n        message = '';\n      } else if (!isValid) {\n        message = t('claim_ens_page.name_message');\n      }\n\n      return /*#__PURE__*/React.createElement(LoggedInDetailPage, {\n        className: \"ClaimENSPage\",\n        hasNavigation: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        height: 48,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Back, {\n        absolute: true,\n        onClick: this.handleBack,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(Narrow, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        className: \"main\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Column, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"avatar-friends\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(Column, {\n        className: \"content\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Section, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Header, {\n        className: \"title\",\n        size: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }\n      }, t('claim_ens_page.title')), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"subtitle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"claim_ens_page.subtitle\",\n        values: {\n          exampleLink: /*#__PURE__*/React.createElement(\"i\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 36\n            }\n          }, \"https://name.dcl.eth\"),\n          br: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"br\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 27\n            }\n          }), /*#__PURE__*/React.createElement(\"br\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 27\n            }\n          })),\n          dclWorldLink: /*#__PURE__*/React.createElement(\"a\", {\n            href: \"http://play.decentraland.org\",\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 25\n            }\n          }, t('claim_ens_page.world')),\n          symbol: /*#__PURE__*/React.createElement(Mana, {\n            size: \"small\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 31\n            }\n          })\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 19\n        }\n      }))), /*#__PURE__*/React.createElement(Form, {\n        onSubmit: this.handleClaim,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Section, {\n        className: name.length === MAX_NAME_SIZE ? 'red' : '',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Field, {\n        label: t('claim_ens_page.name_label'),\n        value: name,\n        message: message,\n        placeholder: t('claim_ens_page.name_placeholder'),\n        action: \"\".concat(name.length, \"/\").concat(MAX_NAME_SIZE),\n        error: isError || hasNameMinLength(name) && !isValid || !isAvailable,\n        onChange: this.handleNameChange,\n        onAction: this.handleAction,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(Section, {\n        className: \"field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Header, {\n        sub: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 19\n        }\n      }, t('claim_ens_page.radio_label')), /*#__PURE__*/React.createElement(NetworkCheck, {\n        network: Network.ETHEREUM,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 19\n        }\n      }, function (isEnabled) {\n        return /*#__PURE__*/React.createElement(Radio, {\n          toggle: true,\n          disabled: isLoading || !isEnabled,\n          checked: isManaAllowed,\n          onChange: _this2.handleManaApprove,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 23\n          }\n        });\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"message\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"claim_ens_page.need_mana_message\",\n        values: {\n          contract_link: /*#__PURE__*/React.createElement(TransactionLink, {\n            address: CONTROLLER_ADDRESS,\n            txHash: \"\",\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 27\n            }\n          }, \"DCLController\")\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }\n      }))), /*#__PURE__*/React.createElement(Row, {\n        className: \"actions\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        className: \"cancel\",\n        onClick: onBack,\n        type: \"button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 19\n        }\n      }, t('global.cancel')), !isLoading && (!isEnoughMana || !isManaAllowed) ? /*#__PURE__*/React.createElement(Popup, {\n        className: \"modal-tooltip\",\n        content: !isEnoughMana ? t('claim_ens_page.not_enough_mana') : !isManaAllowed ? t('claim_ens_page.mana_not_allowed') : '',\n        position: \"top center\",\n        trigger: /*#__PURE__*/React.createElement(\"div\", {\n          className: \"popup-button\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(NetworkButton, {\n          type: \"submit\",\n          primary: true,\n          disabled: isDisabled,\n          loading: isLoading,\n          network: Network.ETHEREUM,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 27\n          }\n        }, t('claim_ens_page.claim_button'), \" \", /*#__PURE__*/React.createElement(Mana, {\n          inline: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 64\n          }\n        }, PRICE.toLocaleString()))),\n        hideOnScroll: true,\n        on: \"hover\",\n        inverted: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }\n      }) : /*#__PURE__*/React.createElement(NetworkButton, {\n        type: \"submit\",\n        primary: true,\n        disabled: isDisabled,\n        loading: isLoading,\n        network: Network.ETHEREUM,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }\n      }, t('claim_ens_page.claim_button'), \" \", /*#__PURE__*/React.createElement(Mana, {\n        inline: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 58\n        }\n      }, PRICE.toLocaleString()))))))));\n    }\n  }]);\n\n  return ClaimENSPage;\n}(React.PureComponent);\n\nexport { ClaimENSPage as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/ClaimENSPage/ClaimENSPage.tsx"],"names":["React","Row","Column","Section","Narrow","Header","Form","Field","Button","Mana","Radio","Popup","Network","T","t","getTokenAmountToApprove","NetworkButton","NetworkCheck","TransactionLink","Back","LoggedInDetailPage","locations","MAX_NAME_SIZE","PRICE","isNameValid","isNameAvailable","hasNameMinLength","isEnoughClaimMana","CONTROLLER_ADDRESS","ClaimENSPage","state","name","isLoading","isAvailable","isError","handleManaApprove","props","allowance","onAllowMana","manaToAllow","toString","handleClaim","wallet","mana","onOpenModal","isValid","isEnoughMana","isManaAllowed","setState","originalName","handleNameChange","_event","data","value","length","handleBack","onNavigate","root","handleAction","onBack","isDisabled","message","exampleLink","br","dclWorldLink","symbol","ETHEREUM","isEnabled","contract_link","toLocaleString","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { Row, Column, Section, Narrow, InputOnChangeData, Header, Form, Field, Button, Mana, Radio, Popup } from 'decentraland-ui'\nimport { Network } from '@dcl/schemas'\nimport { T, t } from 'decentraland-dapps/dist/modules/translation/utils'\nimport { getTokenAmountToApprove } from 'decentraland-dapps/dist/modules/authorization/utils'\nimport { NetworkButton, NetworkCheck, TransactionLink } from 'decentraland-dapps/dist/containers'\nimport Back from 'components/Back'\nimport LoggedInDetailPage from 'components/LoggedInDetailPage'\nimport { locations } from 'routing/locations'\nimport { MAX_NAME_SIZE, PRICE, isNameValid, isNameAvailable, hasNameMinLength, isEnoughClaimMana } from 'modules/ens/utils'\nimport { CONTROLLER_ADDRESS } from 'modules/common/contracts'\nimport { Props, State } from './ClaimENSPage.types'\n\nimport './ClaimENSPage.css'\n\nexport default class ClaimENSPage extends React.PureComponent<Props, State> {\n  state: State = {\n    name: '',\n    isLoading: false,\n    isAvailable: true,\n    isError: false\n  }\n\n  handleManaApprove = async () => {\n    const { allowance, onAllowMana } = this.props\n    const manaToAllow = isEnoughClaimMana(allowance) ? 0 : getTokenAmountToApprove()\n    onAllowMana(manaToAllow.toString())\n  }\n\n  handleClaim = async () => {\n    const { wallet, mana, allowance, onOpenModal } = this.props\n    const { name } = this.state\n\n    const isValid = isNameValid(name)\n    const isEnoughMana = wallet && isEnoughClaimMana(mana.toString())\n    const isManaAllowed = isEnoughClaimMana(allowance)\n\n    if (!isValid || !isEnoughMana || !isManaAllowed) return\n\n    this.setState({ isLoading: true })\n    try {\n      const isAvailable = await isNameAvailable(name)\n      if (isAvailable) {\n        onOpenModal('ClaimNameFatFingerModal', { originalName: name })\n        this.setState({ isLoading: false })\n      } else {\n        this.setState({ isAvailable: false, isLoading: false })\n      }\n    } catch (error) {\n      this.setState({ isLoading: false, isAvailable: true, isError: true })\n    }\n  }\n\n  handleNameChange = (_event: React.ChangeEvent<HTMLInputElement>, data: InputOnChangeData) => {\n    const { isAvailable } = this.state\n    if (data.value.length <= MAX_NAME_SIZE) {\n      if (!isAvailable) {\n        this.setState({ name: data.value, isAvailable: true, isError: false })\n      } else {\n        this.setState({ name: data.value, isError: false })\n      }\n    }\n  }\n\n  handleBack = () => {\n    this.props.onNavigate(locations.root())\n  }\n\n  handleAction = () => {\n    /* noop */\n  }\n\n  render() {\n    const { wallet, mana, allowance, onBack } = this.props\n    const { name, isError, isAvailable } = this.state\n\n    const isLoading = this.props.isLoading || this.state.isLoading\n\n    const isValid = isNameValid(name)\n    const isEnoughMana = wallet && isEnoughClaimMana(mana.toString())\n    const isManaAllowed = isEnoughClaimMana(allowance)\n\n    const isDisabled = !isValid || !isAvailable || !isEnoughMana || !isManaAllowed\n\n    let message: string = ''\n    if (isError) {\n      message = t('claim_ens_page.error_message')\n    } else if (!isAvailable) {\n      message = t('claim_ens_page.repeated_message')\n    } else if (name.length <= 2) {\n      message = ''\n    } else if (!isValid) {\n      message = t('claim_ens_page.name_message')\n    }\n\n    return (\n      <LoggedInDetailPage className=\"ClaimENSPage\" hasNavigation={false}>\n        <Row height={48}>\n          <Back absolute onClick={this.handleBack} />\n        </Row>\n        <Narrow>\n          <Row className=\"main\">\n            <Column>\n              <div className=\"avatar-friends\"></div>\n            </Column>\n            <Column className=\"content\">\n              <Section>\n                <Header className=\"title\" size=\"large\">\n                  {t('claim_ens_page.title')}\n                </Header>\n                <span className=\"subtitle\">\n                  <T\n                    id=\"claim_ens_page.subtitle\"\n                    values={{\n                      exampleLink: <i>https://name.dcl.eth</i>,\n                      br: (\n                        <>\n                          <br />\n                          <br />\n                        </>\n                      ),\n                      dclWorldLink: (\n                        <a href=\"http://play.decentraland.org\" rel=\"noopener noreferrer\" target=\"_blank\">\n                          {t('claim_ens_page.world')}\n                        </a>\n                      ),\n                      symbol: <Mana size=\"small\" />\n                    }}\n                  />\n                </span>\n              </Section>\n              <Form onSubmit={this.handleClaim}>\n                <Section className={name.length === MAX_NAME_SIZE ? 'red' : ''}>\n                  <Field\n                    label={t('claim_ens_page.name_label')}\n                    value={name}\n                    message={message}\n                    placeholder={t('claim_ens_page.name_placeholder')}\n                    action={`${name.length}/${MAX_NAME_SIZE}`}\n                    error={isError || (hasNameMinLength(name) && !isValid) || !isAvailable}\n                    onChange={this.handleNameChange}\n                    onAction={this.handleAction}\n                  />\n                </Section>\n                <Section className=\"field\">\n                  <Header sub={true}>{t('claim_ens_page.radio_label')}</Header>\n                  <NetworkCheck network={Network.ETHEREUM}>\n                    {isEnabled => (\n                      <Radio toggle disabled={isLoading || !isEnabled} checked={isManaAllowed} onChange={this.handleManaApprove} />\n                    )}\n                  </NetworkCheck>\n                  <p className=\"message\">\n                    <T\n                      id=\"claim_ens_page.need_mana_message\"\n                      values={{\n                        contract_link: (\n                          <TransactionLink address={CONTROLLER_ADDRESS} txHash=\"\">\n                            DCLController\n                          </TransactionLink>\n                        )\n                      }}\n                    />\n                  </p>\n                </Section>\n                <Row className=\"actions\">\n                  <Button className=\"cancel\" onClick={onBack} type=\"button\">\n                    {t('global.cancel')}\n                  </Button>\n                  {!isLoading && (!isEnoughMana || !isManaAllowed) ? (\n                    <Popup\n                      className=\"modal-tooltip\"\n                      content={\n                        !isEnoughMana ? t('claim_ens_page.not_enough_mana') : !isManaAllowed ? t('claim_ens_page.mana_not_allowed') : ''\n                      }\n                      position=\"top center\"\n                      trigger={\n                        <div className=\"popup-button\">\n                          <NetworkButton type=\"submit\" primary disabled={isDisabled} loading={isLoading} network={Network.ETHEREUM}>\n                            {t('claim_ens_page.claim_button')} <Mana inline>{PRICE.toLocaleString()}</Mana>\n                          </NetworkButton>\n                        </div>\n                      }\n                      hideOnScroll={true}\n                      on=\"hover\"\n                      inverted\n                    />\n                  ) : (\n                    <NetworkButton type=\"submit\" primary disabled={isDisabled} loading={isLoading} network={Network.ETHEREUM}>\n                      {t('claim_ens_page.claim_button')} <Mana inline>{PRICE.toLocaleString()}</Mana>\n                    </NetworkButton>\n                  )}\n                </Row>\n              </Form>\n            </Column>\n          </Row>\n        </Narrow>\n      </LoggedInDetailPage>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}