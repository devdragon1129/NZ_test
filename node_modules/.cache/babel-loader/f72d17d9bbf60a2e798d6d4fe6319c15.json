{"ast":null,"code":"import _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/EditorPage/EditorPage.tsx\";\nimport * as React from 'react';\nimport { Grid } from 'decentraland-ui';\nimport { getLocalStorage } from 'decentraland-dapps/dist/lib/localStorage';\nimport experiments, { EXPERIMENT_TUTORIAL_OPEN } from 'experiments';\nimport NotFoundPage from 'components/NotFoundPage';\nimport LoadingPage from 'components/LoadingPage';\nimport TopBar from 'components/TopBar';\nimport ViewPort from 'components/ViewPort';\nimport SideBar from 'components/SideBar';\nimport LocalStorageToast from 'components/LocalStorageToast';\nimport Tools from './Tools';\nimport Metrics from './Metrics';\nimport ItemDragLayer from './ItemDragLayer';\nimport './EditorPage.css';\nexport var LOCALSTORAGE_TUTORIAL_KEY = 'builder-tutorial';\nexport var LOCALSTORAGE_INCENTIVE_BANNER_KEY = 'builder-incentive-banner';\nvar TOAST_ITEMS_THRESHOLD = 5; // local storage toast will show when a user has at least this amount of items\n\nvar localStorage = getLocalStorage();\n\nvar EditorPage = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(EditorPage, _React$PureComponent);\n\n  function EditorPage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EditorPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EditorPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      isIncentiveBannerOpen: false\n    };\n\n    _this.handleMouseWheel = function (e) {\n      if (e['ctrlKey']) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      }\n    };\n\n    _this.handleToolClick = function (toolName) {\n      switch (toolName) {\n        case 'shortcuts':\n          _this.props.onOpenModal('ShortcutsModal');\n\n          break;\n\n        case 'zoom-out':\n          _this.props.onZoomOut();\n\n          break;\n\n        case 'zoom-in':\n          _this.props.onZoomIn();\n\n          break;\n\n        case 'reset-camera':\n          _this.props.onResetCamera();\n\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    _this.handleBannerShow = function () {\n      _this.setState({\n        isIncentiveBannerOpen: true\n      });\n    };\n\n    _this.handleBannerClose = function () {\n      _this.setState({\n        isIncentiveBannerOpen: false\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(EditorPage, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this$props = this.props,\n          currentProject = _this$props.currentProject,\n          onOpenModal = _this$props.onOpenModal;\n\n      if (currentProject && !localStorage.getItem(LOCALSTORAGE_TUTORIAL_KEY)) {\n        var showTutorial = experiments.getCurrentValueFor(EXPERIMENT_TUTORIAL_OPEN, true);\n\n        if (showTutorial) {\n          onOpenModal('TutorialModal');\n        }\n      }\n\n      document.body.scrollTop = 0;\n      document.body.classList.add('lock-scroll');\n      document.body.addEventListener('mousewheel', this.handleMouseWheel);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.onCloseEditor();\n      document.body.classList.remove('lock-scroll');\n      document.body.removeEventListener('mousewheel', this.handleMouseWheel);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var isIncentiveBannerOpen = this.state.isIncentiveBannerOpen;\n      var _this$props2 = this.props,\n          currentProject = _this$props2.currentProject,\n          isPreviewing = _this$props2.isPreviewing,\n          isSidebarOpen = _this$props2.isSidebarOpen,\n          isLoading = _this$props2.isLoading,\n          isFetching = _this$props2.isFetching,\n          isLoggedIn = _this$props2.isLoggedIn,\n          numItems = _this$props2.numItems;\n      var gridClasses = isPreviewing ? 'fullscreen' : 'horizontal-layout';\n      var toolbarClasses = isSidebarOpen ? 'toolbar open' : 'toolbar';\n      var wrapperClasses = 'wrapper';\n\n      if (isPreviewing) {\n        wrapperClasses += ' fullscreen';\n      }\n\n      if (isIncentiveBannerOpen && !isPreviewing) {\n        wrapperClasses += ' with-banner';\n      }\n\n      if (isFetching) {\n        return /*#__PURE__*/React.createElement(LoadingPage, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 14\n          }\n        });\n      }\n\n      if (!currentProject) {\n        return /*#__PURE__*/React.createElement(NotFoundPage, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 14\n          }\n        });\n      }\n\n      var showLocalStorageToast = !isLoggedIn && numItems >= TOAST_ITEMS_THRESHOLD;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"EditorPage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 7\n        }\n      }, isPreviewing ? null : /*#__PURE__*/React.createElement(TopBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 32\n        }\n      }), /*#__PURE__*/React.createElement(Grid, {\n        className: gridClasses,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Grid.Row, {\n        className: wrapperClasses,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(ViewPort, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }\n      }), isLoading || isPreviewing ? null : /*#__PURE__*/React.createElement(\"div\", {\n        className: toolbarClasses,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Metrics, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(Tools, {\n        isSidebarOpen: isSidebarOpen,\n        onClick: this.handleToolClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(ItemDragLayer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(LocalStorageToast, {\n        isVisible: showLocalStorageToast,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 19\n        }\n      }))), isPreviewing || !isSidebarOpen ? null : /*#__PURE__*/React.createElement(SideBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 54\n        }\n      }))));\n    }\n  }]);\n\n  return EditorPage;\n}(React.PureComponent);\n\nexport { EditorPage as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/EditorPage/EditorPage.tsx"],"names":["React","Grid","getLocalStorage","experiments","EXPERIMENT_TUTORIAL_OPEN","NotFoundPage","LoadingPage","TopBar","ViewPort","SideBar","LocalStorageToast","Tools","Metrics","ItemDragLayer","LOCALSTORAGE_TUTORIAL_KEY","LOCALSTORAGE_INCENTIVE_BANNER_KEY","TOAST_ITEMS_THRESHOLD","localStorage","EditorPage","state","isIncentiveBannerOpen","handleMouseWheel","e","preventDefault","stopImmediatePropagation","handleToolClick","toolName","props","onOpenModal","onZoomOut","onZoomIn","onResetCamera","handleBannerShow","setState","handleBannerClose","currentProject","getItem","showTutorial","getCurrentValueFor","document","body","scrollTop","classList","add","addEventListener","onCloseEditor","remove","removeEventListener","isPreviewing","isSidebarOpen","isLoading","isFetching","isLoggedIn","numItems","gridClasses","toolbarClasses","wrapperClasses","showLocalStorageToast","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { Grid } from 'decentraland-ui'\nimport { getLocalStorage } from 'decentraland-dapps/dist/lib/localStorage'\nimport experiments, { EXPERIMENT_TUTORIAL_OPEN } from 'experiments'\n\nimport NotFoundPage from 'components/NotFoundPage'\nimport LoadingPage from 'components/LoadingPage'\nimport TopBar from 'components/TopBar'\nimport ViewPort from 'components/ViewPort'\nimport SideBar from 'components/SideBar'\nimport LocalStorageToast from 'components/LocalStorageToast'\nimport Tools from './Tools'\nimport Metrics from './Metrics'\nimport ItemDragLayer from './ItemDragLayer'\nimport { ToolName } from './Tools/Tools.types'\nimport { Props, State } from './EditorPage.types'\n\nimport './EditorPage.css'\n\nexport const LOCALSTORAGE_TUTORIAL_KEY = 'builder-tutorial'\nexport const LOCALSTORAGE_INCENTIVE_BANNER_KEY = 'builder-incentive-banner'\nconst TOAST_ITEMS_THRESHOLD = 5 // local storage toast will show when a user has at least this amount of items\n\nconst localStorage = getLocalStorage()\n\nexport default class EditorPage extends React.PureComponent<Props, State> {\n  state = {\n    isIncentiveBannerOpen: false\n  }\n\n  componentWillMount() {\n    const { currentProject, onOpenModal } = this.props\n\n    if (currentProject && !localStorage.getItem(LOCALSTORAGE_TUTORIAL_KEY)) {\n      const showTutorial = experiments.getCurrentValueFor(EXPERIMENT_TUTORIAL_OPEN, true)\n      if (showTutorial) {\n        onOpenModal('TutorialModal')\n      }\n    }\n\n    document.body.scrollTop = 0\n    document.body.classList.add('lock-scroll')\n    document.body.addEventListener('mousewheel', this.handleMouseWheel)\n  }\n\n  componentWillUnmount() {\n    this.props.onCloseEditor()\n    document.body.classList.remove('lock-scroll')\n    document.body.removeEventListener('mousewheel', this.handleMouseWheel)\n  }\n\n  handleMouseWheel = (e: Event) => {\n    if ((e as WheelEvent)['ctrlKey']) {\n      e.preventDefault()\n      e.stopImmediatePropagation()\n    }\n  }\n\n  handleToolClick = (toolName: ToolName) => {\n    switch (toolName) {\n      case 'shortcuts':\n        this.props.onOpenModal('ShortcutsModal')\n        break\n      case 'zoom-out':\n        this.props.onZoomOut()\n        break\n      case 'zoom-in':\n        this.props.onZoomIn()\n        break\n      case 'reset-camera':\n        this.props.onResetCamera()\n        break\n      default:\n        break\n    }\n  }\n\n  handleBannerShow = () => {\n    this.setState({ isIncentiveBannerOpen: true })\n  }\n  handleBannerClose = () => {\n    this.setState({ isIncentiveBannerOpen: false })\n  }\n\n  render() {\n    const { isIncentiveBannerOpen } = this.state\n    const { currentProject, isPreviewing, isSidebarOpen, isLoading, isFetching, isLoggedIn, numItems } = this.props\n    const gridClasses = isPreviewing ? 'fullscreen' : 'horizontal-layout'\n    const toolbarClasses = isSidebarOpen ? 'toolbar open' : 'toolbar'\n    let wrapperClasses = 'wrapper'\n\n    if (isPreviewing) {\n      wrapperClasses += ' fullscreen'\n    }\n    if (isIncentiveBannerOpen && !isPreviewing) {\n      wrapperClasses += ' with-banner'\n    }\n    if (isFetching) {\n      return <LoadingPage />\n    }\n    if (!currentProject) {\n      return <NotFoundPage />\n    }\n\n    const showLocalStorageToast = !isLoggedIn && numItems >= TOAST_ITEMS_THRESHOLD\n\n    return (\n      <div className=\"EditorPage\">\n        {isPreviewing ? null : <TopBar />}\n        <Grid className={gridClasses}>\n          <Grid.Row className={wrapperClasses}>\n            <ViewPort />\n            {isLoading || isPreviewing ? null : (\n              <div className={toolbarClasses}>\n                <>\n                  <Metrics />\n                  <Tools isSidebarOpen={isSidebarOpen} onClick={this.handleToolClick} />\n                  <ItemDragLayer />\n                  <LocalStorageToast isVisible={showLocalStorageToast} />\n                </>\n              </div>\n            )}\n            {isPreviewing || !isSidebarOpen ? null : <SideBar />}\n          </Grid.Row>\n        </Grid>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}