{"ast":null,"code":"import _objectSpread from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/Modals/EditPriceAndBeneficiaryModal/EditPriceAndBeneficiaryModal.tsx\";\nimport * as React from 'react';\nimport { Address } from 'web3x/address';\nimport { fromWei, toWei } from 'web3x/utils';\nimport { Network } from '@dcl/schemas';\nimport { config } from 'config';\nimport { ModalNavigation, ModalContent, ModalActions, Form, Field, Button, Mana, Card } from 'decentraland-ui';\nimport { NetworkButton } from 'decentraland-dapps/dist/containers';\nimport Modal from 'decentraland-dapps/dist/containers/Modal';\nimport { T, t } from 'decentraland-dapps/dist/modules/translation/utils';\nimport { toFixedMANAValue } from 'decentraland-dapps/dist/lib/mana';\nimport Info from 'components/Info';\nimport { isValid } from 'lib/address';\nimport './EditPriceAndBeneficiaryModal.css';\nvar MIN_SALE_VALUE = fromWei(config.get('MIN_SALE_VALUE_IN_WEI', '0'), 'ether');\n\nvar EditPriceAndBeneficiaryModal = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(EditPriceAndBeneficiaryModal, _React$PureComponent);\n\n  function EditPriceAndBeneficiaryModal(_props) {\n    var _this;\n\n    _classCallCheck(this, EditPriceAndBeneficiaryModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EditPriceAndBeneficiaryModal).call(this, _props));\n    _this.state = {\n      isFree: false\n    };\n\n    _this.handleIsFreeToggle = function () {\n      var isFree = !_this.state.isFree;\n      var beneficiary = isFree ? Address.ZERO.toString() : undefined;\n      var price = isFree ? '0' : undefined;\n\n      _this.setState({\n        isFree: isFree,\n        price: price,\n        beneficiary: beneficiary\n      });\n    };\n\n    _this.handleIsGiftToggle = function () {\n      var item = _this.props.item;\n      var beneficiary = _this.isGift() ? item.owner : undefined;\n\n      var price = _this.getItemPrice();\n\n      _this.setState({\n        beneficiary: beneficiary,\n        price: price,\n        isFree: false\n      });\n    };\n\n    _this.handlePriceChange = function (_event, props) {\n      _this.setState({\n        price: toFixedMANAValue(props.value)\n      });\n    };\n\n    _this.handleBeneficiaryChange = function (_event, props) {\n      var beneficiary = props.value;\n\n      _this.setState({\n        beneficiary: beneficiary\n      });\n    };\n\n    _this.handleSubmit = function () {\n      var _this$props = _this.props,\n          item = _this$props.item,\n          onSave = _this$props.onSave,\n          onSetPriceAndBeneficiary = _this$props.onSetPriceAndBeneficiary;\n      var _this$state = _this.state,\n          price = _this$state.price,\n          beneficiary = _this$state.beneficiary;\n      var priceInWei = toWei(price, 'ether');\n\n      if (item.isPublished) {\n        onSetPriceAndBeneficiary(item.id, priceInWei, beneficiary);\n      } else {\n        var newItem = _objectSpread({}, item, {\n          price: priceInWei,\n          beneficiary: beneficiary\n        });\n\n        onSave(newItem, {});\n      }\n    };\n\n    var _item = _this.props.item;\n\n    if (_item) {\n      _this.state = _objectSpread({}, _this.state, {\n        price: _this.getItemPrice(),\n        beneficiary: _item.beneficiary || _item.owner\n      });\n    }\n\n    return _this;\n  }\n\n  _createClass(EditPriceAndBeneficiaryModal, [{\n    key: \"getItemPrice\",\n    value: function getItemPrice() {\n      var item = this.props.item;\n      return item.price ? fromWei(item.price, 'ether') : undefined;\n    }\n  }, {\n    key: \"isDisabled\",\n    value: function isDisabled() {\n      var isLoading = this.props.isLoading;\n      return !this.isValidPrice() || !this.isValidBeneficiary() || isLoading;\n    }\n  }, {\n    key: \"isGift\",\n    value: function isGift() {\n      var item = this.props.item;\n      var beneficiary = this.state.beneficiary;\n      return beneficiary !== item.owner;\n    }\n  }, {\n    key: \"isValidPrice\",\n    value: function isValidPrice() {\n      var _this$state2 = this.state,\n          price = _this$state2.price,\n          beneficiary = _this$state2.beneficiary;\n      var numberPrice = Number(price);\n      return Number(numberPrice) > 0 || numberPrice === 0 && beneficiary === Address.ZERO.toString();\n    }\n  }, {\n    key: \"isPriceTooLow\",\n    value: function isPriceTooLow() {\n      var _this$state$price = this.state.price,\n          price = _this$state$price === void 0 ? '' : _this$state$price;\n      return price !== '' && price < MIN_SALE_VALUE;\n    }\n  }, {\n    key: \"isValidBeneficiary\",\n    value: function isValidBeneficiary() {\n      var _this$state$beneficia = this.state.beneficiary,\n          beneficiary = _this$state$beneficia === void 0 ? '' : _this$state$beneficia;\n      return isValid(beneficiary);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          name = _this$props2.name,\n          item = _this$props2.item,\n          isLoading = _this$props2.isLoading,\n          onClose = _this$props2.onClose;\n      var _this$state3 = this.state,\n          isFree = _this$state3.isFree,\n          _this$state3$price = _this$state3.price,\n          price = _this$state3$price === void 0 ? '' : _this$state3$price,\n          _this$state3$benefici = _this$state3.beneficiary,\n          beneficiary = _this$state3$benefici === void 0 ? '' : _this$state3$benefici;\n      var isGift = this.isGift();\n      return /*#__PURE__*/React.createElement(Modal, {\n        name: name,\n        size: \"tiny\",\n        onClose: onClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('edit_price_and_beneficiary_modal.title', {\n          name: item.name\n        }),\n        subtitle: /*#__PURE__*/React.createElement(\"div\", {\n          className: \"actions\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(Button, {\n          size: \"mini\",\n          onClick: this.handleIsGiftToggle,\n          active: !isGift,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 15\n          }\n        }, t('edit_price_and_beneficiary_modal.for_me')), /*#__PURE__*/React.createElement(Button, {\n          size: \"mini\",\n          onClick: this.handleIsFreeToggle,\n          active: isFree,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }\n        }, t('edit_price_and_beneficiary_modal.free'))),\n        onClose: onClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Form, {\n        onSubmit: this.handleSubmit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(ModalContent, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"price-field\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Field, {\n        label: t('edit_price_and_beneficiary_modal.price_label', {\n          minPrice: MIN_SALE_VALUE\n        }),\n        placeholder: 100,\n        value: price,\n        onChange: this.handlePriceChange,\n        disabled: isFree,\n        error: !!price && !this.isValidPrice(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(Mana, {\n        network: Network.MATIC,\n        inline: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(Field, {\n        label: /*#__PURE__*/React.createElement(React.Fragment, null, t('edit_price_and_beneficiary_modal.beneficiary_label'), /*#__PURE__*/React.createElement(Info, {\n          content: t('edit_price_and_beneficiary_modal.beneficiary_popup'),\n          className: \"info\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 21\n          }\n        })),\n        type: \"address\",\n        placeholder: \"0x...\",\n        value: beneficiary,\n        disabled: isFree,\n        onChange: this.handleBeneficiaryChange,\n        error: !!beneficiary && !this.isValidBeneficiary(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }\n      }), this.isPriceTooLow() ? /*#__PURE__*/React.createElement(Card, {\n        fluid: true,\n        className: \"min-price-notice\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Card.Content, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"edit_price_and_beneficiary_modal.price_message\",\n        values: {\n          minPrice: /*#__PURE__*/React.createElement(Mana, {\n            inline: true,\n            network: Network.MATIC,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 27\n            }\n          }, MIN_SALE_VALUE),\n          token: t(\"tokens.\".concat(Network.MATIC.toLowerCase())),\n          br: /*#__PURE__*/React.createElement(\"br\", {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 29\n            }\n          })\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }\n      })))) : null), /*#__PURE__*/React.createElement(ModalActions, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(NetworkButton, {\n        primary: true,\n        disabled: this.isDisabled(),\n        loading: isLoading,\n        network: Network.MATIC,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }\n      }, t('global.submit')))));\n    }\n  }]);\n\n  return EditPriceAndBeneficiaryModal;\n}(React.PureComponent);\n\nexport { EditPriceAndBeneficiaryModal as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/Modals/EditPriceAndBeneficiaryModal/EditPriceAndBeneficiaryModal.tsx"],"names":["React","Address","fromWei","toWei","Network","config","ModalNavigation","ModalContent","ModalActions","Form","Field","Button","Mana","Card","NetworkButton","Modal","T","t","toFixedMANAValue","Info","isValid","MIN_SALE_VALUE","get","EditPriceAndBeneficiaryModal","props","state","isFree","handleIsFreeToggle","beneficiary","ZERO","toString","undefined","price","setState","handleIsGiftToggle","item","isGift","owner","getItemPrice","handlePriceChange","_event","value","handleBeneficiaryChange","handleSubmit","onSave","onSetPriceAndBeneficiary","priceInWei","isPublished","id","newItem","isLoading","isValidPrice","isValidBeneficiary","numberPrice","Number","name","onClose","minPrice","MATIC","isPriceTooLow","token","toLowerCase","br","isDisabled","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { Address } from 'web3x/address'\nimport { fromWei, toWei } from 'web3x/utils'\nimport { Network } from '@dcl/schemas'\nimport { config } from 'config'\nimport {\n  ModalNavigation,\n  ModalContent,\n  ModalActions,\n  Form,\n  Field,\n  Button,\n  InputOnChangeData,\n  FieldProps,\n  Mana,\n  Card\n} from 'decentraland-ui'\nimport { NetworkButton } from 'decentraland-dapps/dist/containers'\nimport Modal from 'decentraland-dapps/dist/containers/Modal'\nimport { T, t } from 'decentraland-dapps/dist/modules/translation/utils'\nimport { toFixedMANAValue } from 'decentraland-dapps/dist/lib/mana'\n\nimport Info from 'components/Info'\nimport { isValid } from 'lib/address'\nimport { Item } from 'modules/item/types'\nimport { Props, State } from './EditPriceAndBeneficiaryModal.types'\nimport './EditPriceAndBeneficiaryModal.css'\n\nconst MIN_SALE_VALUE = fromWei(config.get('MIN_SALE_VALUE_IN_WEI', '0')!, 'ether')\n\nexport default class EditPriceAndBeneficiaryModal extends React.PureComponent<Props, State> {\n  state: State = {\n    isFree: false\n  }\n\n  constructor(props: Props) {\n    super(props)\n\n    const { item } = this.props\n    if (item) {\n      this.state = {\n        ...this.state,\n        price: this.getItemPrice(),\n        beneficiary: item.beneficiary || item.owner\n      }\n    }\n  }\n\n  handleIsFreeToggle = () => {\n    const isFree = !this.state.isFree\n    const beneficiary = isFree ? Address.ZERO.toString() : undefined\n    const price = isFree ? '0' : undefined\n    this.setState({ isFree, price, beneficiary })\n  }\n\n  handleIsGiftToggle = () => {\n    const { item } = this.props\n    const beneficiary = this.isGift() ? item.owner : undefined\n    const price = this.getItemPrice()\n    this.setState({ beneficiary, price, isFree: false })\n  }\n\n  handlePriceChange = (_event: React.ChangeEvent<HTMLInputElement>, props: InputOnChangeData) => {\n    this.setState({ price: toFixedMANAValue(props.value) })\n  }\n\n  handleBeneficiaryChange = (_event: React.ChangeEvent<HTMLInputElement>, props: InputOnChangeData) => {\n    const beneficiary = props.value\n    this.setState({ beneficiary })\n  }\n\n  handleSubmit = () => {\n    const { item, onSave, onSetPriceAndBeneficiary } = this.props\n    const { price, beneficiary } = this.state\n    const priceInWei = toWei(price!, 'ether')\n\n    if (item!.isPublished) {\n      onSetPriceAndBeneficiary(item.id, priceInWei, beneficiary!)\n    } else {\n      const newItem: Item = {\n        ...item!,\n        price: priceInWei,\n        beneficiary\n      }\n      onSave(newItem, {})\n    }\n  }\n\n  getItemPrice() {\n    const { item } = this.props\n    return item.price ? fromWei(item.price, 'ether') : undefined\n  }\n\n  isDisabled() {\n    const { isLoading } = this.props\n    return !this.isValidPrice() || !this.isValidBeneficiary() || isLoading\n  }\n\n  isGift() {\n    const { item } = this.props\n    const { beneficiary } = this.state\n    return beneficiary !== item.owner\n  }\n\n  isValidPrice() {\n    const { price, beneficiary } = this.state\n    const numberPrice = Number(price)\n    return Number(numberPrice) > 0 || (numberPrice === 0 && beneficiary === Address.ZERO.toString())\n  }\n\n  isPriceTooLow() {\n    const { price = '' } = this.state\n    return price !== '' && price < MIN_SALE_VALUE\n  }\n\n  isValidBeneficiary() {\n    const { beneficiary = '' } = this.state\n    return isValid(beneficiary)\n  }\n\n  render() {\n    const { name, item, isLoading, onClose } = this.props\n    const { isFree, price = '', beneficiary = '' } = this.state\n\n    const isGift = this.isGift()\n\n    return (\n      <Modal name={name} size=\"tiny\" onClose={onClose}>\n        <ModalNavigation\n          title={t('edit_price_and_beneficiary_modal.title', { name: item.name })}\n          subtitle={\n            <div className=\"actions\">\n              <Button size=\"mini\" onClick={this.handleIsGiftToggle} active={!isGift}>\n                {t('edit_price_and_beneficiary_modal.for_me')}\n              </Button>\n              <Button size=\"mini\" onClick={this.handleIsFreeToggle} active={isFree}>\n                {t('edit_price_and_beneficiary_modal.free')}\n              </Button>\n            </div>\n          }\n          onClose={onClose}\n        />\n\n        <Form onSubmit={this.handleSubmit}>\n          <ModalContent>\n            <div className=\"price-field\">\n              <Field\n                label={t('edit_price_and_beneficiary_modal.price_label', { minPrice: MIN_SALE_VALUE })}\n                placeholder={100}\n                value={price}\n                onChange={this.handlePriceChange}\n                disabled={isFree}\n                error={!!price && !this.isValidPrice()}\n              />\n              <Mana network={Network.MATIC} inline />\n            </div>\n            <Field\n              label={\n                (\n                  <>\n                    {t('edit_price_and_beneficiary_modal.beneficiary_label')}\n                    <Info content={t('edit_price_and_beneficiary_modal.beneficiary_popup')} className=\"info\" />\n                  </>\n                ) as FieldProps['label']\n              }\n              type=\"address\"\n              placeholder=\"0x...\"\n              value={beneficiary}\n              disabled={isFree}\n              onChange={this.handleBeneficiaryChange}\n              error={!!beneficiary && !this.isValidBeneficiary()}\n            />\n            {this.isPriceTooLow() ? (\n              <Card fluid className=\"min-price-notice\">\n                <Card.Content>\n                  <div>\n                    <T\n                      id=\"edit_price_and_beneficiary_modal.price_message\"\n                      values={{\n                        minPrice: (\n                          <Mana inline network={Network.MATIC}>\n                            {MIN_SALE_VALUE}\n                          </Mana>\n                        ),\n                        token: t(`tokens.${Network.MATIC.toLowerCase()}`),\n                        br: <br />\n                      }}\n                    />\n                  </div>\n                </Card.Content>\n              </Card>\n            ) : null}\n          </ModalContent>\n          <ModalActions>\n            <NetworkButton primary disabled={this.isDisabled()} loading={isLoading} network={Network.MATIC}>\n              {t('global.submit')}\n            </NetworkButton>\n          </ModalActions>\n        </Form>\n      </Modal>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}