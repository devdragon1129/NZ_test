{"ast":null,"code":"import _defineProperty from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport { loadingReducer } from 'decentraland-dapps/dist/modules/loading/reducer';\nimport { DEPLOY_BATCHED_THIRD_PARTY_ITEMS_SUCCESS, PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE, PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST, PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS, PUBLISH_THIRD_PARTY_ITEMS_FAILURE, PUBLISH_THIRD_PARTY_ITEMS_REQUEST, PUBLISH_THIRD_PARTY_ITEMS_SUCCESS, PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE, PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST, PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS } from 'modules/thirdParty/actions';\nimport { FETCH_ITEM_CURATIONS_REQUEST, FETCH_ITEM_CURATIONS_SUCCESS, FETCH_ITEM_CURATIONS_FAILURE, FETCH_ITEM_CURATION_SUCCESS, FETCH_ITEM_CURATION_REQUEST, FETCH_ITEM_CURATION_FAILURE } from './actions';\nexport var INITIAL_STATE = {\n  data: {},\n  loading: [],\n  error: null\n};\nexport function itemCurationReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : INITIAL_STATE;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case PUBLISH_THIRD_PARTY_ITEMS_REQUEST:\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST:\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST:\n    case FETCH_ITEM_CURATION_REQUEST:\n    case FETCH_ITEM_CURATIONS_REQUEST:\n      return _objectSpread({}, state, {\n        loading: loadingReducer(state.loading, action)\n      });\n\n    case FETCH_ITEM_CURATION_SUCCESS:\n      {\n        var _state$data$collectio;\n\n        var _action$payload = action.payload,\n            collectionId = _action$payload.collectionId,\n            itemCuration = _action$payload.itemCuration;\n        var oldCurations = ((_state$data$collectio = state.data[collectionId]) === null || _state$data$collectio === void 0 ? void 0 : _state$data$collectio.filter(function (c) {\n          return c.itemId !== (itemCuration === null || itemCuration === void 0 ? void 0 : itemCuration.itemId);\n        })) || [];\n        return _objectSpread({}, state, {\n          loading: loadingReducer(state.loading, action),\n          data: _objectSpread({}, state.data, _defineProperty({}, collectionId, [].concat(_toConsumableArray(oldCurations), [itemCuration]))),\n          error: null\n        });\n      }\n\n    case DEPLOY_BATCHED_THIRD_PARTY_ITEMS_SUCCESS:\n      {\n        var _action$payload2 = action.payload,\n            collection = _action$payload2.collection,\n            itemCurations = _action$payload2.itemCurations;\n        return _objectSpread({}, state, {\n          data: _objectSpread({}, state.data, _defineProperty({}, collection.id, _toConsumableArray(itemCurations)))\n        });\n      }\n\n    case FETCH_ITEM_CURATIONS_SUCCESS:\n      {\n        var _action$payload3 = action.payload,\n            _itemCurations = _action$payload3.itemCurations,\n            _collectionId = _action$payload3.collectionId;\n        var currentItemCurations = state.data[_collectionId];\n        return _objectSpread({}, state, {\n          loading: loadingReducer(state.loading, action),\n          data: _objectSpread({}, state.data, _defineProperty({}, _collectionId, currentItemCurations ? [].concat(_toConsumableArray(currentItemCurations.filter(function (itemCuration) {\n            return !_itemCurations.find(function (curation) {\n              return curation.itemId === itemCuration.itemId;\n            });\n          })), _toConsumableArray(_itemCurations)) : _itemCurations)),\n          error: null\n        });\n      }\n\n    case PUBLISH_THIRD_PARTY_ITEMS_SUCCESS:\n      {\n        var _action$payload4 = action.payload,\n            _itemCurations2 = _action$payload4.itemCurations,\n            _collectionId2 = _action$payload4.collectionId;\n        var oldItemCurations = state.data[_collectionId2];\n        var mergedItemCurations = oldItemCurations ? [].concat(_toConsumableArray(oldItemCurations), _toConsumableArray(_itemCurations2)) : _toConsumableArray(_itemCurations2);\n        return _objectSpread({}, state, {\n          loading: loadingReducer(state.loading, action),\n          data: _objectSpread({}, state.data, _defineProperty({}, _collectionId2, mergedItemCurations)),\n          error: null\n        });\n      }\n\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS:\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS:\n      {\n        var _action$payload5 = action.payload,\n            newItemCurations = _action$payload5.itemCurations,\n            _collectionId3 = _action$payload5.collectionId;\n        var _oldItemCurations = state.data[_collectionId3];\n        var newCurationsItemIds = newItemCurations.map(function (newItemCuration) {\n          return newItemCuration.itemId;\n        });\n\n        var oldCurationsNotIncludedInNewOnes = _oldItemCurations.filter(function (oldItemCuration) {\n          return !newCurationsItemIds.includes(oldItemCuration.itemId);\n        });\n\n        return _objectSpread({}, state, {\n          loading: loadingReducer(state.loading, action),\n          data: _objectSpread({}, state.data, _defineProperty({}, _collectionId3, [].concat(_toConsumableArray(oldCurationsNotIncludedInNewOnes), _toConsumableArray(newItemCurations)))),\n          error: null\n        });\n      }\n\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE:\n    case PUBLISH_THIRD_PARTY_ITEMS_FAILURE:\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE:\n    case FETCH_ITEM_CURATIONS_FAILURE:\n    case FETCH_ITEM_CURATION_FAILURE:\n      var error = action.payload.error;\n      return _objectSpread({}, state, {\n        loading: loadingReducer(state.loading, action),\n        error: error\n      });\n\n    default:\n      return state;\n  }\n}","map":{"version":3,"sources":["/opt/work/NZ_test/src/modules/curations/itemCuration/reducer.ts"],"names":["loadingReducer","DEPLOY_BATCHED_THIRD_PARTY_ITEMS_SUCCESS","PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE","PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST","PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS","PUBLISH_THIRD_PARTY_ITEMS_FAILURE","PUBLISH_THIRD_PARTY_ITEMS_REQUEST","PUBLISH_THIRD_PARTY_ITEMS_SUCCESS","PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE","PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST","PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS","FETCH_ITEM_CURATIONS_REQUEST","FETCH_ITEM_CURATIONS_SUCCESS","FETCH_ITEM_CURATIONS_FAILURE","FETCH_ITEM_CURATION_SUCCESS","FETCH_ITEM_CURATION_REQUEST","FETCH_ITEM_CURATION_FAILURE","INITIAL_STATE","data","loading","error","itemCurationReducer","state","action","type","payload","collectionId","itemCuration","oldCurations","filter","c","itemId","collection","itemCurations","id","currentItemCurations","find","curation","oldItemCurations","mergedItemCurations","newItemCurations","newCurationsItemIds","map","newItemCuration","oldCurationsNotIncludedInNewOnes","oldItemCuration","includes"],"mappings":"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","sourcesContent":["import { loadingReducer, LoadingState } from 'decentraland-dapps/dist/modules/loading/reducer'\nimport {\n  DeployBatchedThirdPartyItemsSuccessAction,\n  DEPLOY_BATCHED_THIRD_PARTY_ITEMS_SUCCESS,\n  PublishAndPushChangesThirdPartyItemsFailureAction,\n  PublishAndPushChangesThirdPartyItemsRequestAction,\n  PublishAndPushChangesThirdPartyItemsSuccessAction,\n  PublishThirdPartyItemsFailureAction,\n  PublishThirdPartyItemsRequestAction,\n  PublishThirdPartyItemsSuccessAction,\n  PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE,\n  PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST,\n  PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS,\n  PUBLISH_THIRD_PARTY_ITEMS_FAILURE,\n  PUBLISH_THIRD_PARTY_ITEMS_REQUEST,\n  PUBLISH_THIRD_PARTY_ITEMS_SUCCESS,\n  PushChangesThirdPartyItemsFailureAction,\n  PushChangesThirdPartyItemsRequestAction,\n  PushChangesThirdPartyItemsSuccessAction,\n  PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE,\n  PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST,\n  PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS\n} from 'modules/thirdParty/actions'\nimport {\n  FETCH_ITEM_CURATIONS_REQUEST,\n  FETCH_ITEM_CURATIONS_SUCCESS,\n  FETCH_ITEM_CURATIONS_FAILURE,\n  FetchItemCurationsRequestAction,\n  FetchItemCurationsFailureAction,\n  FetchItemCurationsSuccessAction,\n  FETCH_ITEM_CURATION_SUCCESS,\n  FetchItemCurationSuccessAction,\n  FETCH_ITEM_CURATION_REQUEST,\n  FetchItemCurationFailureAction,\n  FetchItemCurationRequestAction,\n  FETCH_ITEM_CURATION_FAILURE\n} from './actions'\nimport { ItemCuration } from './types'\n\nexport type ItemCurationState = {\n  data: Record<string, ItemCuration[]>\n  loading: LoadingState\n  error: string | null\n}\n\nexport const INITIAL_STATE: ItemCurationState = {\n  data: {},\n  loading: [],\n  error: null\n}\n\ntype CurationReducerAction =\n  | FetchItemCurationRequestAction\n  | FetchItemCurationSuccessAction\n  | FetchItemCurationFailureAction\n  | FetchItemCurationsRequestAction\n  | FetchItemCurationsSuccessAction\n  | FetchItemCurationsFailureAction\n  | PublishThirdPartyItemsRequestAction\n  | PublishThirdPartyItemsSuccessAction\n  | PublishThirdPartyItemsFailureAction\n  | PushChangesThirdPartyItemsRequestAction\n  | PushChangesThirdPartyItemsSuccessAction\n  | PushChangesThirdPartyItemsFailureAction\n  | PublishAndPushChangesThirdPartyItemsRequestAction\n  | PublishAndPushChangesThirdPartyItemsSuccessAction\n  | PublishAndPushChangesThirdPartyItemsFailureAction\n  | DeployBatchedThirdPartyItemsSuccessAction\n\nexport function itemCurationReducer(state: ItemCurationState = INITIAL_STATE, action: CurationReducerAction): ItemCurationState {\n  switch (action.type) {\n    case PUBLISH_THIRD_PARTY_ITEMS_REQUEST:\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST:\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_REQUEST:\n    case FETCH_ITEM_CURATION_REQUEST:\n    case FETCH_ITEM_CURATIONS_REQUEST:\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action)\n      }\n    case FETCH_ITEM_CURATION_SUCCESS: {\n      const { collectionId, itemCuration } = action.payload\n      const oldCurations = state.data[collectionId]?.filter(c => c.itemId !== itemCuration?.itemId) || []\n\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action),\n        data: {\n          ...state.data,\n          [collectionId]: [...oldCurations, itemCuration]\n        },\n        error: null\n      }\n    }\n    case DEPLOY_BATCHED_THIRD_PARTY_ITEMS_SUCCESS: {\n      const { collection, itemCurations } = action.payload\n\n      return {\n        ...state,\n        data: {\n          ...state.data,\n          [collection.id]: [...itemCurations]\n        }\n      }\n    }\n    case FETCH_ITEM_CURATIONS_SUCCESS: {\n      const { itemCurations, collectionId } = action.payload\n      const currentItemCurations = state.data[collectionId]\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action),\n        data: {\n          ...state.data,\n          [collectionId]: currentItemCurations\n            ? [\n                ...currentItemCurations.filter(itemCuration => !itemCurations.find(curation => curation.itemId === itemCuration.itemId)),\n                ...itemCurations\n              ]\n            : itemCurations\n        },\n        error: null\n      }\n    }\n    case PUBLISH_THIRD_PARTY_ITEMS_SUCCESS: {\n      const { itemCurations, collectionId } = action.payload\n      const oldItemCurations = state.data[collectionId]\n      const mergedItemCurations = oldItemCurations ? [...oldItemCurations, ...itemCurations] : [...itemCurations]\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action),\n        data: {\n          ...state.data,\n          [collectionId]: mergedItemCurations\n        },\n        error: null\n      }\n    }\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS:\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_SUCCESS: {\n      const { itemCurations: newItemCurations, collectionId } = action.payload\n      const oldItemCurations = state.data[collectionId]\n      const newCurationsItemIds = newItemCurations.map(newItemCuration => newItemCuration.itemId)\n      const oldCurationsNotIncludedInNewOnes = oldItemCurations.filter(\n        oldItemCuration => !newCurationsItemIds.includes(oldItemCuration.itemId)\n      )\n\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action),\n        data: {\n          ...state.data,\n          [collectionId]: [...oldCurationsNotIncludedInNewOnes, ...newItemCurations]\n        },\n        error: null\n      }\n    }\n    case PUBLISH_AND_PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE:\n    case PUBLISH_THIRD_PARTY_ITEMS_FAILURE:\n    case PUSH_CHANGES_THIRD_PARTY_ITEMS_FAILURE:\n    case FETCH_ITEM_CURATIONS_FAILURE:\n    case FETCH_ITEM_CURATION_FAILURE:\n      const { error } = action.payload\n\n      return {\n        ...state,\n        loading: loadingReducer(state.loading, action),\n        error\n      }\n    default:\n      return state\n  }\n}\n"]},"metadata":{},"sourceType":"module"}