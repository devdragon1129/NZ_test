{"ast":null,"code":"import _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/SideBar/EntityEditor/EntityField/EntityField.tsx\";\nimport * as React from 'react';\nimport { SelectField, Popup, Search } from 'decentraland-ui';\nimport { t } from 'decentraland-dapps/dist/modules/translation/utils';\nimport './EntityField.css';\nvar MAX_LENGTH = 6;\n\nvar EntityField = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(EntityField, _React$PureComponent);\n\n  function EntityField() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EntityField);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EntityField)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      value: _this.props.value || '',\n      search: ''\n    };\n\n    _this.handleChange = function (_, props) {\n      var onChange = _this.props.onChange;\n      var value = props.value;\n\n      _this.setState({\n        value: value\n      });\n\n      onChange(value);\n    };\n\n    _this.renderTrigger = function () {\n      var assetsByEntityName = _this.props.assetsByEntityName;\n      var value = _this.state.value;\n      var asset = assetsByEntityName[value];\n\n      if (!asset) {\n        return /*#__PURE__*/React.createElement(\"span\", {\n          className: \"trigger\",\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 40,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"text\",\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 41,\n            columnNumber: 11\n          }\n        }, \"Select item...\"));\n      }\n\n      return /*#__PURE__*/React.createElement(\"span\", {\n        className: \"trigger\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: asset.thumbnail,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: \"text\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 9\n        }\n      }, value));\n    };\n\n    _this.handleSearchChange = function (_, data) {\n      _this.setState({\n        search: data.value\n      });\n    };\n\n    _this.handleBlur = function () {\n      _this.setState({\n        search: ''\n      });\n    };\n\n    _this.handleInputClick = function (e) {\n      e.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  _createClass(EntityField, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          id = _this$props.id,\n          label = _this$props.label,\n          entities = _this$props.entities,\n          filter = _this$props.filter,\n          assetsByEntityName = _this$props.assetsByEntityName,\n          _this$props$className = _this$props.className,\n          className = _this$props$className === void 0 ? '' : _this$props$className,\n          _this$props$direction = _this$props.direction,\n          direction = _this$props$direction === void 0 ? 'left' : _this$props$direction;\n      var _this$state = this.state,\n          value = _this$state.value,\n          search = _this$state.search;\n      var options = Object.values(entities).filter(function (entity) {\n        return !entity.disableGizmos && !!assetsByEntityName[entity.name];\n      }).map(function (entity) {\n        return {\n          key: entity.name,\n          text: entity.name,\n          value: entity.name,\n          image: {\n            avatar: false,\n            src: assetsByEntityName[entity.name].thumbnail\n          }\n        };\n      });\n\n      if (filter) {\n        options = options.filter(function (option) {\n          return filter.includes(option.key);\n        });\n      }\n\n      if (search.length > 0) {\n        options = options.filter(function (option) {\n          return option.key.toLowerCase().includes(search.toLowerCase());\n        });\n      }\n\n      if (options.length === 0) {\n        options.push({\n          key: 'not-found',\n          text: t('itemdrawer.no_results'),\n          value: 0,\n          disabled: false,\n          className: 'no-results'\n        });\n      }\n\n      var showSearch = options.length >= 5 || search.length > 0;\n      var content = /*#__PURE__*/React.createElement(SelectField, {\n        id: id,\n        value: value,\n        options: options,\n        onChange: this.handleChange,\n        onBlur: this.handleBlur,\n        header: showSearch ? /*#__PURE__*/React.createElement(Search, {\n          placeholder: t('itemdrawer.search_items'),\n          className: \"search-field\",\n          input: {\n            icon: 'search',\n            iconPosition: 'left',\n            inverted: true\n          },\n          onSearchChange: this.handleSearchChange,\n          onClick: this.handleInputClick,\n          value: search,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 13\n          }\n        }) : undefined,\n        trigger: this.renderTrigger(),\n        search: false,\n        direction: direction === null ? undefined : direction,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 7\n        }\n      });\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"EntityField ParameterField \".concat(className),\n        title: \"Item\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 7\n        }\n      }, label && /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: id,\n        className: \"label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }\n      }, label), value.length > MAX_LENGTH ? /*#__PURE__*/React.createElement(Popup, {\n        content: value,\n        position: \"top center\",\n        trigger: content,\n        on: \"hover\",\n        inverted: true,\n        basic: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 38\n        }\n      }) : content);\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props) {\n      if (props.value) {\n        return {\n          value: props.value\n        };\n      }\n\n      return null;\n    }\n  }]);\n\n  return EntityField;\n}(React.PureComponent);\n\nexport { EntityField as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/SideBar/EntityEditor/EntityField/EntityField.tsx"],"names":["React","SelectField","Popup","Search","t","MAX_LENGTH","EntityField","state","value","props","search","handleChange","_","onChange","setState","renderTrigger","assetsByEntityName","asset","thumbnail","handleSearchChange","data","handleBlur","handleInputClick","e","stopPropagation","id","label","entities","filter","className","direction","options","Object","values","entity","disableGizmos","name","map","key","text","image","avatar","src","option","includes","length","toLowerCase","push","disabled","showSearch","content","icon","iconPosition","inverted","undefined","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { SelectField, DropdownProps, Popup, Search, SearchProps, DropdownItemProps } from 'decentraland-ui'\nimport { t } from 'decentraland-dapps/dist/modules/translation/utils'\nimport { Asset } from 'modules/asset/types'\nimport { Props, State } from './EntityField.types'\nimport './EntityField.css'\n\nconst MAX_LENGTH = 6\n\nexport default class EntityField extends React.PureComponent<Props, State> {\n  state: State = {\n    value: this.props.value || '',\n    search: ''\n  }\n\n  static getDerivedStateFromProps(props: Props) {\n    if (props.value) {\n      return {\n        value: props.value\n      }\n    }\n\n    return null\n  }\n\n  handleChange = (_: any, props: DropdownProps) => {\n    const { onChange } = this.props\n    const value = props.value as string\n    this.setState({ value })\n    onChange(value)\n  }\n\n  renderTrigger = () => {\n    const { assetsByEntityName } = this.props\n    const { value } = this.state\n    const asset = assetsByEntityName[value] as Asset | undefined\n\n    if (!asset) {\n      return (\n        <span className=\"trigger\">\n          <span className=\"text\">Select item...</span>\n        </span>\n      )\n    }\n\n    return (\n      <span className=\"trigger\">\n        <img src={asset.thumbnail} />\n        <span className=\"text\">{value}</span>\n      </span>\n    )\n  }\n\n  handleSearchChange = (_: React.MouseEvent<HTMLElement, MouseEvent>, data: SearchProps) => {\n    this.setState({\n      search: data.value as string\n    })\n  }\n\n  handleBlur = () => {\n    this.setState({\n      search: ''\n    })\n  }\n\n  handleInputClick = (e: any) => {\n    e.stopPropagation()\n  }\n\n  render() {\n    const { id, label, entities, filter, assetsByEntityName, className = '', direction = 'left' } = this.props\n    const { value, search } = this.state\n\n    let options: DropdownItemProps[] = Object.values(entities)\n      .filter(entity => !entity.disableGizmos && !!assetsByEntityName[entity.name])\n      .map(entity => ({\n        key: entity.name,\n        text: entity.name,\n        value: entity.name,\n        image: { avatar: false, src: assetsByEntityName[entity.name].thumbnail }\n      }))\n\n    if (filter) {\n      options = options.filter(option => filter.includes(option.key))\n    }\n\n    if (search.length > 0) {\n      options = options.filter(option => option.key.toLowerCase().includes(search.toLowerCase()))\n    }\n\n    if (options.length === 0) {\n      options.push({\n        key: 'not-found',\n        text: t('itemdrawer.no_results'),\n        value: 0,\n        disabled: false,\n        className: 'no-results'\n      })\n    }\n\n    const showSearch = options.length >= 5 || search.length > 0\n\n    const content = (\n      <SelectField\n        id={id}\n        value={value}\n        options={options}\n        onChange={this.handleChange}\n        onBlur={this.handleBlur}\n        header={\n          showSearch ? (\n            <Search\n              placeholder={t('itemdrawer.search_items')}\n              className=\"search-field\"\n              input={{ icon: 'search', iconPosition: 'left', inverted: true }}\n              onSearchChange={this.handleSearchChange}\n              onClick={this.handleInputClick}\n              value={search}\n            />\n          ) : (\n            undefined\n          )\n        }\n        trigger={this.renderTrigger()}\n        search={false}\n        direction={direction === null ? undefined : direction}\n      />\n    )\n\n    return (\n      <div className={`EntityField ParameterField ${className}`} title=\"Item\">\n        {label && (\n          <label htmlFor={id} className=\"label\">\n            {label}\n          </label>\n        )}\n\n        {value.length > MAX_LENGTH ? <Popup content={value} position=\"top center\" trigger={content} on=\"hover\" inverted basic /> : content}\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}