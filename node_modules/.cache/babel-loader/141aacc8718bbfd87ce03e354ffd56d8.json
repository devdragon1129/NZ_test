{"ast":null,"code":"import _regeneratorRuntime from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/opt/work/NZ_test/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/opt/work/NZ_test/src/components/Modals/PublishCollectionModalOld/PublishCollectionModal.tsx\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport * as React from 'react';\nimport { Network } from '@dcl/schemas';\nimport { ModalNavigation, Button, Mana, Loader, Field, Form } from 'decentraland-ui';\nimport Modal from 'decentraland-dapps/dist/containers/Modal';\nimport { t, T } from 'decentraland-dapps/dist/modules/translation/utils';\nimport { config } from 'config';\nimport { getBackgroundStyle } from 'modules/item/utils';\nimport { emailRegex } from 'lib/validators';\nimport './PublishCollectionModal.css';\n\nvar PublishCollectionModal = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(PublishCollectionModal, _React$PureComponent);\n\n  function PublishCollectionModal() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PublishCollectionModal);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PublishCollectionModal)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      step: 1,\n      email: undefined,\n      emailFocus: false\n    };\n\n    _this.handleNextStep = function () {\n      _this.setState({\n        step: 3\n      });\n    };\n\n    _this.handlePublish = function () {\n      var _this$props = _this.props,\n          collection = _this$props.collection,\n          items = _this$props.items,\n          onPublish = _this$props.onPublish;\n      var email = _this.state.email;\n      onPublish(collection, items, email);\n    };\n\n    _this.handleEmailChange = function (_, data) {\n      _this.setState({\n        email: data.value\n      });\n    };\n\n    _this.handleEmailFocus = function () {\n      _this.setState({\n        emailFocus: true\n      });\n    };\n\n    _this.handleEmailBlur = function () {\n      _this.setState({\n        emailFocus: false\n      });\n    };\n\n    _this.handleProceed = function () {\n      _this.setState({\n        step: 2\n      });\n    };\n\n    _this.renderFirstStep = function () {\n      var _this$props2 = _this.props,\n          items = _this$props2.items,\n          wallet = _this$props2.wallet,\n          onClose = _this$props2.onClose,\n          rarities = _this$props2.rarities,\n          isFetchingItems = _this$props2.isFetchingItems,\n          isFetchingRarities = _this$props2.isFetchingRarities;\n      var itemsByRarity = {}; // This is the publication fee price in MANA set for all rarities at the date of 2022-05-20\n      // in the Rarities contract https://polygonscan.com/address/0x17113b44fdd661A156cc01b5031E3aCF72c32EB3.\n      // When migrating to the new RaritiesWithOracle contract and feature, the first thing to be done is to redeploy\n      // the graph https://thegraph.com/hosted-service/subgraph/decentraland/collections-matic-mainnet with the new rarities\n      // https://github.com/decentraland/collections-graph/pull/51.\n      //\n      // When the graph finishes to publish, rarity prices will be different. And in order to prevent showing a differenet price\n      // than what will be actually charged for publishing a collection before the rarities contract is updated in the CollectionManager\n      // contract, a solution is to just hardcode the price (as there are no plans to change it) of the old rarities until\n      // the whole prices pegged to usd feature comes to life.\n      //\n      // This is a temporal solution, when the feature is implemented, the whole PublishCollectionModalOld directory will be erased in\n      // favor of the PublishCollectionModalWithOracle.\n\n      var hardcodedPrice = 100;\n      var totalPrice = hardcodedPrice * items.length;\n\n      var _iterator = _createForOfIteratorHelper(items),\n          _step;\n\n      try {\n        var _loop = function _loop() {\n          var item = _step.value;\n          var rarity = rarities.find(function (rarity) {\n            return rarity.name === item.rarity;\n          });\n\n          if (!rarity) {\n            return \"continue\";\n          }\n\n          if (!itemsByRarity[rarity.id]) {\n            itemsByRarity[rarity.id] = {\n              id: rarity.id,\n              name: rarity.name,\n              count: 0,\n              price: 0\n            };\n          }\n\n          itemsByRarity[rarity.name].count++;\n        };\n\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _ret = _loop();\n\n          if (_ret === \"continue\") continue;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var hasInsufficientMANA = !!wallet && wallet.networks.MATIC.mana < totalPrice;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal.title'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"first-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 9\n        }\n      }, isFetchingItems || isFetchingRarities ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"loader-wrapper\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Loader, {\n        size: \"big\",\n        active: isFetchingRarities,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }\n      })) : /*#__PURE__*/React.createElement(React.Fragment, null, t('publish_collection_modal.items_breakdown_title', {\n        count: items.length\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"items-breakdown\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }\n      }, Object.values(itemsByRarity).map(function (itemByRarity) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"item\",\n          key: itemByRarity.name,\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"i\", {\n          className: \"item-rarity\",\n          style: getBackgroundStyle(itemByRarity.id),\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 23\n          }\n        }), itemByRarity.count, \" \", itemByRarity.name), /*#__PURE__*/React.createElement(\"div\", {\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(Mana, {\n          network: Network.MATIC,\n          __self: _assertThisInitialized(_assertThisInitialized(_this)),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 23\n          }\n        }, hardcodedPrice * itemByRarity.count)));\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"item total\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 19\n        }\n      }, t('global.total')), /*#__PURE__*/React.createElement(\"div\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(Mana, {\n        network: Network.MATIC,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 21\n        }\n      }, totalPrice)))), /*#__PURE__*/React.createElement(Button, {\n        className: \"proceed\",\n        primary: true,\n        fluid: true,\n        onClick: _this.handleProceed,\n        disabled: hasInsufficientMANA,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 15\n        }\n      }, t('global.next')), hasInsufficientMANA ? /*#__PURE__*/React.createElement(\"small\", {\n        className: \"not-enough-mana-notice\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal.not_enough_mana\",\n        values: {\n          symbol: /*#__PURE__*/React.createElement(\"span\", {\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(Mana, {\n            network: Network.MATIC,\n            inline: true,\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 27\n            }\n          }), \" MANA\")\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 19\n        }\n      }), /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal.get_mana\",\n        values: {\n          link: /*#__PURE__*/React.createElement(\"a\", {\n            href: config.get('ACCOUNT_URL', ''),\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 25\n            }\n          }, \"Account\")\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 19\n        }\n      })) : null)));\n    };\n\n    _this.renderSecondStep = function () {\n      var onClose = _this.props.onClose;\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal.title_tos'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"second-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 9\n        }\n      }, t('publish_collection_modal.first_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal.second_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal.third_paragraph'), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"divider\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }\n      }), t('publish_collection_modal.fourth_paragraph'), ' ', /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://docs.decentraland.org/wearables/publishing-wearables\",\n        rel: \"noopener noreferrer\",\n        target: \"_blank\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }\n      }, t('global.learn_more')), /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        fluid: true,\n        onClick: _this.handleNextStep,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }\n      }, t('global.next'))));\n    };\n\n    _this.renderThirdStep = function () {\n      var _this$props3 = _this.props,\n          isPublishLoading = _this$props3.isPublishLoading,\n          unsyncedCollectionError = _this$props3.unsyncedCollectionError,\n          onClose = _this$props3.onClose;\n      var _this$state = _this.state,\n          email = _this$state.email,\n          emailFocus = _this$state.emailFocus;\n      var hasValidEmail = emailRegex.test(email !== null && email !== void 0 ? email : '');\n      var showEmailError = !hasValidEmail && !emailFocus && email !== undefined && email !== '';\n      return /*#__PURE__*/React.createElement(Form, {\n        onSubmit: _this.handlePublish,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ModalNavigation, {\n        title: t('publish_collection_modal.title_tos'),\n        onClose: onClose,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(Modal.Content, {\n        className: \"third-step\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tos\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal.tos_title')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(T, {\n        id: \"publish_collection_modal.tos_first_condition\",\n        values: {\n          terms_of_use: /*#__PURE__*/React.createElement(\"a\", {\n            href: \"https://decentraland.org/terms/\",\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 21\n            }\n          }, t('publish_collection_modal.terms_of_use')),\n          content_policy: /*#__PURE__*/React.createElement(\"a\", {\n            href: \"https://decentraland.org/content/\",\n            rel: \"noopener noreferrer\",\n            target: \"_blank\",\n            __self: _assertThisInitialized(_assertThisInitialized(_this)),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 21\n            }\n          }, t('publish_collection_modal.content_policy'))\n        },\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal.tos_second_condition')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 13\n        }\n      }, t('publish_collection_modal.tos_third_condition'))), /*#__PURE__*/React.createElement(Field, {\n        label: t('global.email'),\n        placeholder: 'email@decentraland.org',\n        onFocus: _this.handleEmailFocus,\n        onBlur: _this.handleEmailBlur,\n        onChange: _this.handleEmailChange,\n        error: showEmailError,\n        message: showEmailError ? t('publish_collection_modal.invalid_email') : undefined,\n        value: email,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(Modal.Actions, {\n        className: \"third-step-footer\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        primary: true,\n        fluid: true,\n        disabled: !hasValidEmail || isPublishLoading || !!unsyncedCollectionError,\n        loading: isPublishLoading,\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }\n      }, t('global.publish')), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }\n      }, t('publish_collection_modal.accept_by_publishing')), unsyncedCollectionError && /*#__PURE__*/React.createElement(\"p\", {\n        className: \"error\",\n        __self: _assertThisInitialized(_assertThisInitialized(_this)),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 39\n        }\n      }, t('publish_collection_modal.unsynced_collection'))));\n    };\n\n    _this.renderStep = function () {\n      var step = _this.state.step;\n\n      switch (step) {\n        case 1:\n          return _this.renderFirstStep();\n\n        case 2:\n          return _this.renderSecondStep();\n\n        case 3:\n          return _this.renderThirdStep();\n\n        default:\n          throw new Error('Step not found');\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(PublishCollectionModal, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$props4, collection, onClose, onFetchRarities, rarities;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this$props4 = this.props, collection = _this$props4.collection, onClose = _this$props4.onClose, onFetchRarities = _this$props4.onFetchRarities, rarities = _this$props4.rarities;\n\n                if (!collection) {\n                  onClose();\n                }\n\n                if (rarities.length === 0) {\n                  onFetchRarities();\n                }\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var onClose = this.props.onClose;\n      return /*#__PURE__*/React.createElement(Modal, {\n        className: \"PublishCollectionModal\",\n        size: \"tiny\",\n        onClose: onClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 7\n        }\n      }, this.renderStep());\n    }\n  }]);\n\n  return PublishCollectionModal;\n}(React.PureComponent);\n\nexport { PublishCollectionModal as default };","map":{"version":3,"sources":["/opt/work/NZ_test/src/components/Modals/PublishCollectionModalOld/PublishCollectionModal.tsx"],"names":["React","Network","ModalNavigation","Button","Mana","Loader","Field","Form","Modal","t","T","config","getBackgroundStyle","emailRegex","PublishCollectionModal","state","step","email","undefined","emailFocus","handleNextStep","setState","handlePublish","props","collection","items","onPublish","handleEmailChange","_","data","value","handleEmailFocus","handleEmailBlur","handleProceed","renderFirstStep","wallet","onClose","rarities","isFetchingItems","isFetchingRarities","itemsByRarity","hardcodedPrice","totalPrice","length","item","rarity","find","name","id","count","price","hasInsufficientMANA","networks","MATIC","mana","Object","values","map","itemByRarity","symbol","link","get","renderSecondStep","renderThirdStep","isPublishLoading","unsyncedCollectionError","hasValidEmail","test","showEmailError","terms_of_use","content_policy","renderStep","Error","onFetchRarities","PureComponent"],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { Network } from '@dcl/schemas'\nimport { ModalNavigation, Button, Mana, Loader, Field, InputOnChangeData, Form } from 'decentraland-ui'\nimport Modal from 'decentraland-dapps/dist/containers/Modal'\nimport { t, T } from 'decentraland-dapps/dist/modules/translation/utils'\nimport { config } from 'config'\nimport { ItemRarity } from 'modules/item/types'\nimport { getBackgroundStyle } from 'modules/item/utils'\nimport { emailRegex } from 'lib/validators'\nimport { Props, State } from './PublishCollectionModal.types'\nimport './PublishCollectionModal.css'\n\nexport default class PublishCollectionModal extends React.PureComponent<Props, State> {\n  state: State = { step: 1, email: undefined, emailFocus: false }\n\n  async componentDidMount() {\n    const { collection, onClose, onFetchRarities, rarities } = this.props\n    if (!collection) {\n      onClose()\n    }\n\n    if (rarities.length === 0) {\n      onFetchRarities()\n    }\n  }\n\n  handleNextStep = () => {\n    this.setState({ step: 3 })\n  }\n\n  handlePublish = () => {\n    const { collection, items, onPublish } = this.props\n    const { email } = this.state\n    onPublish(collection!, items, email!)\n  }\n\n  handleEmailChange = (_: unknown, data: InputOnChangeData): void => {\n    this.setState({ email: data.value })\n  }\n\n  handleEmailFocus = () => {\n    this.setState({ emailFocus: true })\n  }\n\n  handleEmailBlur = () => {\n    this.setState({ emailFocus: false })\n  }\n\n  handleProceed = () => {\n    this.setState({ step: 2 })\n  }\n\n  renderFirstStep = () => {\n    const { items, wallet, onClose, rarities, isFetchingItems, isFetchingRarities } = this.props\n\n    const itemsByRarity: Record<string, { id: ItemRarity; name: ItemRarity; count: number; price: number }> = {}\n\n    // This is the publication fee price in MANA set for all rarities at the date of 2022-05-20\n    // in the Rarities contract https://polygonscan.com/address/0x17113b44fdd661A156cc01b5031E3aCF72c32EB3.\n    // When migrating to the new RaritiesWithOracle contract and feature, the first thing to be done is to redeploy\n    // the graph https://thegraph.com/hosted-service/subgraph/decentraland/collections-matic-mainnet with the new rarities\n    // https://github.com/decentraland/collections-graph/pull/51.\n    //\n    // When the graph finishes to publish, rarity prices will be different. And in order to prevent showing a differenet price\n    // than what will be actually charged for publishing a collection before the rarities contract is updated in the CollectionManager\n    // contract, a solution is to just hardcode the price (as there are no plans to change it) of the old rarities until\n    // the whole prices pegged to usd feature comes to life.\n    //\n    // This is a temporal solution, when the feature is implemented, the whole PublishCollectionModalOld directory will be erased in\n    // favor of the PublishCollectionModalWithOracle.\n    const hardcodedPrice = 100\n    const totalPrice = hardcodedPrice * items.length\n\n    for (const item of items) {\n      const rarity = rarities.find(rarity => rarity.name === item.rarity)\n\n      if (!rarity) {\n        continue\n      }\n\n      if (!itemsByRarity[rarity.id]) {\n        itemsByRarity[rarity.id] = { id: rarity.id, name: rarity.name, count: 0, price: 0 }\n      }\n\n      itemsByRarity[rarity.name].count++\n    }\n\n    const hasInsufficientMANA = !!wallet && wallet.networks.MATIC.mana < totalPrice\n\n    return (\n      <>\n        <ModalNavigation title={t('publish_collection_modal.title')} onClose={onClose} />\n        <Modal.Content className=\"first-step\">\n          {isFetchingItems || isFetchingRarities ? (\n            <div className=\"loader-wrapper\">\n              <Loader size=\"big\" active={isFetchingRarities} />\n            </div>\n          ) : (\n            <>\n              {t('publish_collection_modal.items_breakdown_title', { count: items.length })}\n              <div className=\"items-breakdown\">\n                {Object.values(itemsByRarity).map(itemByRarity => (\n                  <div className=\"item\" key={itemByRarity.name}>\n                    <div>\n                      <i className=\"item-rarity\" style={getBackgroundStyle(itemByRarity.id)}></i>\n                      {itemByRarity.count} {itemByRarity.name}\n                    </div>\n                    <div>\n                      <Mana network={Network.MATIC}>{hardcodedPrice * itemByRarity.count}</Mana>\n                    </div>\n                  </div>\n                ))}\n                <div className=\"item total\">\n                  <div>{t('global.total')}</div>\n                  <div>\n                    <Mana network={Network.MATIC}>{totalPrice}</Mana>\n                  </div>\n                </div>\n              </div>\n              <Button className=\"proceed\" primary fluid onClick={this.handleProceed} disabled={hasInsufficientMANA}>\n                {t('global.next')}\n              </Button>\n              {hasInsufficientMANA ? (\n                <small className=\"not-enough-mana-notice\">\n                  <T\n                    id=\"publish_collection_modal.not_enough_mana\"\n                    values={{\n                      symbol: (\n                        <span>\n                          <Mana network={Network.MATIC} inline /> MANA\n                        </span>\n                      )\n                    }}\n                  />\n                  <br />\n                  <T\n                    id=\"publish_collection_modal.get_mana\"\n                    values={{\n                      link: (\n                        <a href={config.get('ACCOUNT_URL', '')} rel=\"noopener noreferrer\" target=\"_blank\">\n                          Account\n                        </a>\n                      )\n                    }}\n                  />\n                </small>\n              ) : null}\n            </>\n          )}\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderSecondStep = () => {\n    const { onClose } = this.props\n\n    return (\n      <>\n        <ModalNavigation title={t('publish_collection_modal.title_tos')} onClose={onClose} />\n        <Modal.Content className=\"second-step\">\n          {t('publish_collection_modal.first_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal.second_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal.third_paragraph')}\n          <div className=\"divider\"></div>\n          {t('publish_collection_modal.fourth_paragraph')}{' '}\n          <a href=\"https://docs.decentraland.org/wearables/publishing-wearables\" rel=\"noopener noreferrer\" target=\"_blank\">\n            {t('global.learn_more')}\n          </a>\n          <Button primary fluid onClick={this.handleNextStep}>\n            {t('global.next')}\n          </Button>\n        </Modal.Content>\n      </>\n    )\n  }\n\n  renderThirdStep = () => {\n    const { isPublishLoading, unsyncedCollectionError, onClose } = this.props\n    const { email, emailFocus } = this.state\n    const hasValidEmail = emailRegex.test(email ?? '')\n    const showEmailError = !hasValidEmail && !emailFocus && email !== undefined && email !== ''\n\n    return (\n      <Form onSubmit={this.handlePublish}>\n        <ModalNavigation title={t('publish_collection_modal.title_tos')} onClose={onClose} />\n        <Modal.Content className=\"third-step\">\n          <div className=\"tos\">\n            <p>{t('publish_collection_modal.tos_title')}</p>\n            <p>\n              <T\n                id=\"publish_collection_modal.tos_first_condition\"\n                values={{\n                  terms_of_use: (\n                    <a href=\"https://decentraland.org/terms/\" rel=\"noopener noreferrer\" target=\"_blank\">\n                      {t('publish_collection_modal.terms_of_use')}\n                    </a>\n                  ),\n                  content_policy: (\n                    <a href=\"https://decentraland.org/content/\" rel=\"noopener noreferrer\" target=\"_blank\">\n                      {t('publish_collection_modal.content_policy')}\n                    </a>\n                  )\n                }}\n              />\n            </p>\n            <p>{t('publish_collection_modal.tos_second_condition')}</p>\n            <p>{t('publish_collection_modal.tos_third_condition')}</p>\n          </div>\n          <Field\n            label={t('global.email')}\n            placeholder={'email@decentraland.org'}\n            onFocus={this.handleEmailFocus}\n            onBlur={this.handleEmailBlur}\n            onChange={this.handleEmailChange}\n            error={showEmailError}\n            message={showEmailError ? t('publish_collection_modal.invalid_email') : undefined}\n            value={email}\n          />\n        </Modal.Content>\n        <Modal.Actions className=\"third-step-footer\">\n          <Button primary fluid disabled={!hasValidEmail || isPublishLoading || !!unsyncedCollectionError} loading={isPublishLoading}>\n            {t('global.publish')}\n          </Button>\n          <p>{t('publish_collection_modal.accept_by_publishing')}</p>\n          {unsyncedCollectionError && <p className=\"error\">{t('publish_collection_modal.unsynced_collection')}</p>}\n        </Modal.Actions>\n      </Form>\n    )\n  }\n\n  renderStep = () => {\n    const { step } = this.state\n    switch (step) {\n      case 1:\n        return this.renderFirstStep()\n      case 2:\n        return this.renderSecondStep()\n      case 3:\n        return this.renderThirdStep()\n      default:\n        throw new Error('Step not found')\n    }\n  }\n\n  render() {\n    const { onClose } = this.props\n\n    return (\n      <Modal className=\"PublishCollectionModal\" size=\"tiny\" onClose={onClose}>\n        {this.renderStep()}\n      </Modal>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}